## Please edit system and help pages ONLY in the moinmaster wiki! For more
## information, please see MoinMaster:MoinPagesEditorGroup.
##acl MoinPagesEditorGroup:read,write,delete,revert All:read
##master-page:HelpTemplate
##master-date:Unknown-Date
#format wiki
#language en
'''Создание пользовательских отчетов'''

''Данная статья была написана при содействии компании '' [:ivantageLimited:ivantage Limited]'', авторизованного консультанта по программному обеспечению Urchin ''

Чтобы создать пользовательский отчет, выполните следующие действия:
  1. Создайте новую папку для нового типа пользовательского профиля в каталоге 

&lt;Urchin&gt;

/lib/custom/profiletypes/ (например, 

&lt;Urchin&gt;

/lib/custom/profiletypes/custom\_pt)
> 2. Выберите один из типов таблиц карт данных или задайте новый (см. раздел ["Пользовательские карты данных"]) и сохраните его в новой папке (например, 

&lt;Urchin&gt;

/lib/custom/profiletypes/custom\_pt/). Внимание! Не переименовывайте файл ".dm2".
> 3. Создайте новый (".rs2") файл набора отчетов (этот файл необходим для управления навигацией и способом отображения панелей инструментов и отчетов) на основе файла 

&lt;Urchin&gt;

/lib/custom/profiletypes/Default/default.rs2.sample и сохраните его (например, под именем 

&lt;Urchin&gt;

/lib/custom/profiletypes/custom\_pt/custom\_rs.rs2).
> 4. Определите новый отчет, добавив новую строку в файл набора отчетов, используя описанный ниже формат файла набора отчетов.
> 5. Свяжите свой профиль с пользовательской картой данных и набором отчетов, как описано ниже:

![http://www.google.com/urchin/images/wiki/HowToCreateCustomReports_1.jpg](http://www.google.com/urchin/images/wiki/HowToCreateCustomReports_1.jpg)

'''Формат файла набора отчетов'''

  * ID – уникальный идентификатор отчета:
    * C=категория;
    * D=данные;
    * M=меню;
    * R=отчет;
    * S=подотчет;
    * P=отчет по странице;
    * B=панель инструментов.
  * RS – разделы панели инструментов/отчетов:
    * 1=руководитель;
    * 2=маркетолог;
    * 4=веб-мастер;
    * 8=рекламодатель (Urchin 6.6+).
  * RR – требования к отчету:
    * 1=программное обеспечение;
    * 2=расширенные параметры (отчеты со специальными настройками в подотчетах "Ценность на данный момент", "Эффективность сочетаний сегментов", "Подробные исторические данные о посетителях", "Информация о транзакциях" требуют использования расширенных функций профиля);
    * 4=электронная торговля (отчет отображается для профиля, созданного для сайта электронной торговли);
    * 8=UTM(отчет отображается для профиля UTM).
  * NTITLE – название на панели навигации (номер записи словаря в файле /lib/reporting/languages/en-US.txt или пользовательском словаре).
  * ONCOLOR – цвет при выборе элемента на панели навигации.
  * OFFCOLOR – цвет при отсутствии выбора элемента на панели навигации.
  * HELP – справка по отчету (номер статьи в словаре).
  * NDATA – количество элементов данных (затем должны следовать вхождения):
    * Это поле можно использовать перед списком дополнительных подотчетов типа D (данные).
  * CTITLES – заголовки столбцов (номер статьи в словаре).
  * CTYPES – тип столбцов, используемых при форматировании:
    * 10=строка;
    * 11=дата/месяц года;
    * 12=дата;
    * 20=кол-во;
    * 21=доход;
    * 22=байты;
    * 23=режим;
    * 24=соотношение;
    * 25=процент;
    * 26=время;
    * 30=общий процент;
    * 40=доход;
    * 41=доход/кол-во;
    * 42=кол-во/доход.
  * TABLE – номер таблицы данных (в lib/custom/reporting/profiletypes/custom\_pt/datamap.dm2):
    * T=итого;
    * TR=транзакция;
    * H=гистограмма;
    * V=посетитель;
    * 1-n (таблица).
  * DXFORMAT – формат извлечения данных.
  * RF – обязательное поле.
  * RT – тип отчета:
    * 1=итоговые данные на графике;
    * 2=гистограмма;
    * 3=диаграмма с областями;
    * 4=основной;
    * 5=дерево;
    * 6=каталог;
    * 7=только график;
    * 8=точка;
    * 9=CTR;
    * 10=определенная последовательность конверсии;
    * 11=наложение на главную страницу;
    * 12=наложение на карту;
    * 13=проверка цели;
    * 14=путь к цели;
    * 20=отчет по датам для основных показателей эффективности;
    * 21=топ-10 основных показателей эффективности;
    * 22=сводка тенденций;
    * 23=сводка по конверсиям;
    * 24=мини-карта.
  * GTYPES – типы диаграмм:
    * 1=гистограмма;
    * 2=линейчатая диаграмма;
    * 3=круговая диаграмма;
    * 4=горизонтальная гистограмма;
    * 5=функциональный;
    * 6=комплексный график.
  * FSEP – разделитель полей.
  * SP – специальные настройки (добавьте числа для битовой карты):
    * 1=суммарные значения;
    * 2=средние значения;
    * 4=сравнение дат;
    * 8=в нижний регистр;
    * 16=изменение данных с течением времени;
    * 32=наложение;
    * 64=поиск языка;
    * 128=сегмент;
    * 256=общая ценность;
    * 512=информация о транзакции;
    * 1024=подробная информация о посетителях;
    * 2048=поиск термина.
  * SR – специальная метка отчета:
    * 1=варианты ключевых слов;
    * 2=CTR;
    * 3=разбивка по времени суток;
    * 4=список посетителей;
    * 5=наложение на карту;
    * 6=пользовательский словарь для персонального использования;
    * 7=сравнение дат.
  * FNT – номер фильтра, тип фильтра:
    * 1: =
    * 2: >=
    * 3: <=
    * 4: >
    * 5: <
  * FNF – поле номера фильтра.
  * FNV – значение фильтра.
  * FST – тип строки фильтра:
    * 1= исключить;
    * 2= включить.
  * FSF – поле строки фильтра.
  * FSX – строка регулярного выражения.

Ниже приведен пример одной строки отчета с пояснениями:


|ID | S1208 | Подотчет с идентификатором 1208 |
|:--|:------|:--------------------------------------------------------|
|DS  | 1 |Раздел отчетов для руководства |
|RR |	8 |Необходимо включение UTM |
|NTITLE |	162 | Название в меню навигации |
|ONCOLOR |	#A2C488 |	Цвет при наведении на меню |
|OFFCOLOR |	#D0E1C3 |	Цвет при отсутствии наведения на меню |
|HELP |	163 | Справочная статья |
|NDATA |	- | Нет подотчетов с данными |
| CTITLES | 73,2,17,54,55,56,57,74,75	| Заголовки столбцов для таблицы с отчетом |
| CTYPES |	10,20,24,25,25,25,25,24,41 | Типы столбцов для таблицы с отчетом |
| TABLE |	1 | Идентификатор карты данных |
|DXFORMAT |	$A[$B],11,5/11,28/11,29/11,30/11,31/11,15/11,19/11 |Формат извлечения данных |
|RF |	- | Нет обязательных полей |
|RT |	4 | Тип отчета – "основной" |
|GTYPES |	3,4 |	Два типа диаграмм: "круговая диаграмма" и "горизонтальная гистограмма" |
| FSEP	| - |Разделитель полей не используется |
| SP	| 1428 | Использованы следующие специальные параметры: 4 (сравнение дат); 16 (изменение данных с течением времени); 128 (сегмент); 256 (общая ценность); 1024 (подробная информация о посетителях) |
|SR	| - | Регулярный отчет |
| FNT	| - | Дополнительный фильтр не используется |
| FNF	| - | Дополнительный фильтр не используется |
| FNV	| - | Дополнительный фильтр не используется |
| FST  | - | Дополнительный фильтр не используется |
| FSF	| - | Дополнительный фильтр не используется |
| FSX	| - | Дополнительный фильтр не используется |

'''Пример: копирование набора отчетов'''

  1. Скопируйте нужные разделы файла ".rs2" в конец файла ".rs2". (Например, скопируйте разделы файла ".rs2", в которых упоминаются панель инструментов "Рекламодатель", некоторые ее отчеты – "Сводка по маркетингу" и "Конверсии в кампании" – и некоторые отчеты панели управления "Руководитель" – "Сводка по маркетингу" и "Наложение на географическую карту". Дайте панели управления название "Рекламодатель и руководитель", а первому отчету – название "Сводка для рекламодателя и руководителя".)
> 2. Присвойте каждому элементу уникальный идентификатор (например, присвойте идентификатор "B2400" новой панели управления, а идентификаторы "[R2401](https://code.google.com/p/urchin-web-analytics-software/source/detail?r=2401)", "[R2401](https://code.google.com/p/urchin-web-analytics-software/source/detail?r=2401)", "[R2402](https://code.google.com/p/urchin-web-analytics-software/source/detail?r=2402)", "[R2403](https://code.google.com/p/urchin-web-analytics-software/source/detail?r=2403)", "[R2404](https://code.google.com/p/urchin-web-analytics-software/source/detail?r=2404)", "[R2405](https://code.google.com/p/urchin-web-analytics-software/source/detail?r=2405)" – новым отчетам).
> 3. Присвойте уникальный идентификатор всем элементам NTITLE (например, присвойте идентификатор "895" элементу NTITLE панели управления "Рекламодатель и руководитель", а идентификатор "896" – элементу NTITLE отчета "Сводка для рекламодателя и руководителя").
> 4. Укажите NTITLE в файле /lib/reporting/languages/en-US.txt. Например, добавьте две строки в файл "en-US.txt", как показано на этом изображении:

![http://www.google.com/urchin/images/wiki/HowToCreateCustomReports_2.jpg](http://www.google.com/urchin/images/wiki/HowToCreateCustomReports_2.jpg)

Использование файла карты данных

Файл ".rs2" содержит ссылку на идентификатор таблицы из файла ".dm2", в котором, в свою очередь, размещена ссылка на определения списка полей из /lib/reporting/logformats/fieldlist.txt.

![http://www.google.com/urchin/images/wiki/HowToCreateCustomReports_3.jpg](http://www.google.com/urchin/images/wiki/HowToCreateCustomReports_3.jpg)

В файле карты данных указан формат столбца, состоящий из одной строки в таблице. Для каждой таблицы используется уникальный идентификатор. (Подробнее о файле ".dm2" читайте в разделе ["Пользовательские карты данных"].)