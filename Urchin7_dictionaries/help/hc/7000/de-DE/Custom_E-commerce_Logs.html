<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Benutzerdefinierte E-Commerce-Protokolle</strong> <p class="line867"><strong>Übersicht</strong> <p class="line862">Viele Warenkörbe können nicht automatisch von Urchin verarbeitet werden, da sie das Erfassen und Protokollieren wertvoller Kaufinformationen auch in anderen Formaten als ELF2 zulassen. In diesem Artikel wird erklärt, wie Sie ein benutzerdefiniertes Protokollformat für Ihre E-Commerce-Protokolldatei erstellen, falls Sie Ihren Warenkorb nicht auf das Generieren von ELF2 ändern können. Lesen Sie bitte <a href="Custom_Log_Formats.html">Benutzerdefinierte Protokollformate</a>, bevor Sie fortfahren. In diesem Artikel wird das Erstellen benutzerdefinierter Protokolle ausführlich beschrieben. <p class="line867"><strong>E-Commerce-Protokollformattypen</strong> <p class="line874">Warenkörbe sind so ausgelegt, dass Informationen zu Käufen und den gekauften Artikeln in einem einzeiligen oder einem mehrzeiligen Format protokolliert werden. Beim einzeiligen Format enthält jede Zeile alle erforderlichen Informationen für eine vollständige Beschreibung der Transaktion und der gekauften Artikel. Außerdem haben alle Zeilen dasselbe Layout. Bei mehrzeiligen Formaten wird der Kaufvorgang in mehreren Zeilen beschrieben. Dabei weisen die Transaktionszeilen ein anderes Format auf als die Zeilen mit den gekauften Artikeln. ELF2-Protokolle entsprechen mehrzeiligen Formaten. Stellen Sie fest, ob die Daten in Ihren E-Commerce-Protokollen in einer oder mehreren Zeilen erfasst werden. Denn davon hängt ab, wie Sie Ihr benutzerdefiniertes Protokollformat einrichten. Folgen Sie je nach Typ des Protokollformats den nachstehenden Anleitungen. <p class="line867"><strong>Allgemeine Anforderungen zur E-Commerce-Protokollierung</strong> <p class="line874">Unabhängig vom Format der Protokolleinträge Ihres Warenkorbs muss jeder Eintrag das Datum und die Uhrzeit und mindestens eines der folgenden Felder enthalten, damit ein Zusammenhang mit den Besuchern hergestellt werden kann: <ul><li>Remote-Host oder IP-Adresse (für Besucher-Tracking-Methoden "Nur IP" oder "IP+User-Agent") </li><li><p class="line891">UserAgent (für Besucher-Tracking-Methode "IP+User-Agent") </li><li>Cookies (für Besucher-Tracking-Methode "UTM" oder "SID") </li><li>Sitzungs-ID (für Besucher-Tracking-Methode "SID") </li></ul><p class="line874">Fehlt eines der oben aufgeführten Felder, kann in Urchin keine sinnvolle Analyse Ihres Umsatzes erstellt werden. In Urchin werden außerdem folgende E-Commerce-Felder definiert: <ul><li>%{ORDERID} entspricht der Auftragsnummer. </li><li>%{STORE} entspricht dem Namen/der ID des Shops. </li><li>%{SESSIONID} entspricht der eindeutigen Sitzungskennung des Kunden. </li><li>%{TOTAL} entspricht dem Gesamtbetrag der Transaktion, einschließlich Steuern und Versandkosten (nur Dezimalstellen, keine "$"-Zeichen). </li><li>%{TAX} entspricht dem Steuerbetrag, der zur Zwischensumme hinzugerechnet wird. </li><li>%{SHIPPING} entspricht den Versandkosten. </li><li>%{BILL_CITY} entspricht der Stadt der Rechnungsadresse des Kunden. </li><li>%{BILL_STATE} entspricht dem Bundesland der Rechnungsadresse des Kunden. </li><li>%{BILL_ZIP} entspricht der Postleitzahl der Rechnungsadresse des Kunden. </li><li>%{BILL_COUNTRY} entspricht dem Land der Rechnungsadresse des Kunden. </li><li>%{PRODUCT_CODE} entspricht dem Kennzeichner des Produkts. </li><li>%{PRODUCT_NAME} entspricht dem Namen des Produkts. </li><li>%{VARIATION} entspricht einer optionalen Variation des Produkts, z. B. hinsichtlich Farbe oder Größe. </li><li>%{PRICE} entspricht dem Einheitspreis des Produkts (nur Dezimalstellen, keine "$"-Zeichen). </li><li>%{QUANTITY} entspricht der Bestellmenge des Produkts. </li><li>%{UPSOLD} entspricht einem booleschen Wert (0|1), wenn das Produkt zum Verkauf stand. </li></ul><p class="line867"><strong>Protokolle im einzeiligen Format</strong> <p class="line874">Gehen Sie folgendermaßen vor, wenn Ihr E-Commerce-Protokoll wie oben erläutert nur Treffer mit demselben Zeilenformat enthält. <ol type="1"><li>Erstellen Sie im Verzeichnis "lib/custom/logformats" ein neues benutzerdefiniertes Protokollformat. Erstellen Sie dazu eine Kopie der Protokollformatdatei "custom.lf.sample". Benennen Sie Ihre Kopie mit der Dateierweiterung ".lf". </li><li>Bearbeiten Sie die neue benutzerdefinierte Protokollformatdatei, indem Sie anhand der unten aufgeführten Empfehlungen die folgenden Einträge festlegen: <ul><li><p class="line891">PrimaryPositions: Dieser Eintrag gibt die Reihenfolge der Felder in der Protokolldatei an. Erstellen Sie eine durch Kommas getrennte Liste mit Feld-IDs, in der die Feldreihenfolge beschrieben wird. Die Feldnamen und IDs sind in der Datei "lib/reporting/logformats/fieldlist.txt" enthalten. Siehe unten stehendes Beispiel. </li><li><p class="line891">SecondaryPositions: Lassen Sie "-" unverändert, da dieser Eintrag für Protokolldateien mit einzeiligem Format nicht verwendet wird. </li><li><p class="line891">PrimaryKey: Lassen Sie "-" unverändert, da dieser Eintrag für Protokolldateien mit einzeiligem Format nicht verwendet wird. </li><li><p class="line891">SecondaryKey: Lassen Sie "-" unverändert, da dieser Eintrag für Protokolldateien mit einzeiligem Format nicht verwendet wird. </li><li><p class="line891">PrimaryContent: TRANSACTION oder ITEM sind gültige Einträge für dieses Feld. Legen Sie diesen Eintrag auf ITEM fest, wenn sich die Treffer in Ihrer Protokolldatei jeweils auf den Kauf einzelner Produkte beziehen. Beziehen sich die Treffer in der Protokolldatei auf den gesamten Kaufvorgang, legen Sie diesen Eintrag auf TRANSACTION fest. </li><li><p class="line891">SecondaryContent: Lassen Sie "-" unverändert, da dieser Eintrag für Protokolldateien mit einzeiligem Format nicht verwendet wird. </li><li><p class="line891">CommentKey: Wenn einige Zeilen in der Protokolldatei nicht als Treffer angesehen werden und mit einem bestimmten Zeichen beginnen, geben Sie das Zeichen hier ein. </li><li><p class="line891">FieldSeparator1: Mit den FieldSeparator-Einträgen werden die als Feldtrennzeichen verwendeten Zeichen definiert. In der Regel werden Tabulator- (\t) und Leerzeichen (\s) eingegeben. Legen Sie diese Einträge anhand der Zeichen zwischen den Feldern in Ihrer Protokolldatei fest. </li><li><p class="line891">FieldSeparator2: Siehe "FieldSeparator1" oben. </li><li><p class="line891">QuotesEscapeSep: Damit wird angegeben, ob Feldtrennzeichen in einem Feld ignoriert werden, das Anführungszeichen ("") enthält. Der Eintrag YES sollte in der Regel unverändert bleiben. </li><li><p class="line891">BracketsEscapeSep: Damit wird angegeben, ob Feldtrennzeichen in einem Feld ignoriert werden, das Klammern ([]) enthält. Der Eintrag YES sollte in der Regel unverändert bleiben. </li><li><p class="line891">MergSuccessiveSep: Damit wird angegeben, ob zwei Trennzeichen in einer Zeile als ein Trennzeichen behandelt werden sollen. Der Eintrag NO kann in der Regel unverändert bleiben. </li><li><p class="line891">CleanWhiteSpace: Damit wird angegeben, ob Leerzeichen am Ende von Feldern beim Analysieren der Felder entfernt werden sollen. Der Eintrag NO kann in der Regel unverändert bleiben. </li><li><p class="line891">StatusRequired: Lassen Sie den Eintrag auf NO, sofern Ihre Treffer keine Statuscodes vom Typ Webserver enthalten. </li><li><p class="line891">CustomDateFormat: Enthält Ihr Protokollformat ein benutzerdefiniertes Datumsformat, legen Sie das entsprechende strptime-Format zur Beschreibung des Eintrags fest. </li><li><p class="line891">CustomTimeFormat: Enthält Ihr Protokollformat ein benutzerdefiniertes Zeitformat, legen Sie das entsprechende strptime-Format zur Beschreibung des Eintrags fest. </li></ul></li><li>Speichern Sie Ihr benutzerdefiniertes Protokollformat im Verzeichnis "lib/custom/logformats". </li><li>Wählen Sie das benutzerdefinierte Protokollformat für Ihre Protokollquelle in der Benutzeroberfläche von Urchin Admin aus. </li><li>Verarbeiten Sie Ihre Protokolldateien in Urchin. </li></ol><p class="line867"><strong>Beispiel für ein einzeiliges Format</strong> <p class="line874">Das folgende Beispiel veranschaulicht einen einzelnen Treffer aus einem Protokoll mit ausschließlich Transaktionsdaten. <p class="line867"><pre>12345 123.123.123.123 "Urchin Store" [26/Aug/2003:11:43:02 -0700] 192.73 "San Diego" "CA" 92101 "US" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;)" "utma=171060324.2734232095.1061444425.1061444425.1061444763.2"
</pre><p class="line862">Die folgende Liste zeigt die einzelnen Feldnamen und die jeweils aus der Datei "lib/reporting/logformats/fieldslist.txt" abgerufenen ID-Nummern. Die so zugewiesenen ID-Nummern werden im Feld "PrimaryPositions" Ihrer benutzerdefinierten Protokollformatdatei verwendet. <ol type="1"><li>Transaktions-ID 25 </li><li>Remote-Host oder IP-Adresse 12 </li><li>Name des Shops 26 </li><li>Apache-Datum/Zeit 3 </li><li>Gesamtkosten 28 </li><li>Rechnungsstadt 31 </li><li>Rechnungsbundesland 32 </li><li>Rechnungs-PLZ 33 </li><li>Rechnungsland 34 </li><li class="gap">User-Agent 13 </li><li>Cookies 14 </li></ol><p class="line874">Anhand der obigen Liste können Sie die folgenden Einträge in der benutzerdefinierten Protokollformatdatei festlegen: <p class="line867"><pre>PrimaryPositions: "25, 12, 26, 3, 28, 31, 32, 33, 34, 13, 14" SecondaryPositions: - PrimaryKey: - SecondaryKey: - PrimaryContent: TRANSACTION SecondaryContent: - CommentKey: # FieldSeparator1: \s FieldSeparator2: \t QuotesEscapeSep: YES BracketsEscapeSep: YES MergSuccessiveSep: NO CleanWhiteSpace: NO StatusRequired: NO CustomDateFormat: - CustomTimeFormat: -
</pre><p class="line862">Unter "PrimaryPositions" wird die Reihenfolge der Felder angegeben. Mit "PrimaryContent" wird für Urchin angegeben, dass dieses Protokoll Transaktionen (oder allgemeine Informationen zu Käufen) enthält. Die Feldtrennzeichen sind auf Leer- und Tabulatorzeichen festgelegt, da die Felder durch Leerzeichen getrennt werden. Die benutzerdefinierten Datums-/Zeitformate werden nicht angegeben, da Datum/Zeit als Apache-Datum formatiert wurde. <p class="line867"><strong>Protokolle im mehrzeiligen Format</strong> <p class="line874">Urchin kann mehrzeilige Formate lesen. Dazu muss jedoch jede Zeile mit einem bestimmten Zeichen beginnen, mit dem das verwendete Format identifiziert wird. Die ELF2-Protokolldateien enthalten z. B. ein Ausrufezeichen "!" am Anfang einer Transaktionszeile. Die Artikelzeilen enthalten KEINE vorangestellten "!"-Zeichen. <p class="line874">Gehen Sie folgendermaßen vor, wenn Ihr E-Commerce-Protokoll verschiedene Formatzeilen für die Transaktion und die Produkt- oder Artikelinformationen enthält. <ol type="1"><li>Erstellen Sie im Verzeichnis lib/custom/logformats ein neues benutzerdefiniertes Protokollformat. Erstellen Sie dazu eine Kopie der Protokollformatdatei "custom.lf.sample". Benennen Sie Ihre Kopie mit der Dateierweiterung ".lf". </li><li>Bearbeiten Sie die neue benutzerdefinierte Protokollformatdatei, indem Sie anhand der unten aufgeführten Empfehlungen die folgenden Einträge festlegen: <ul><li><p class="line891">PrimaryPositions: Dieser Eintrag gibt die Reihenfolge der Felder in der Protokolldatei an. Erstellen Sie eine durch Kommas getrennte Liste mit Feld-IDs, in der die Feldreihenfolge beschrieben wird. Die Feldnamen und IDs sind in der Datei "lib/reporting/logformats/fieldlist.txt" enthalten. </li><li><p class="line891">SecondaryPositions: Dieser Eintrag gibt die Reihenfolge der Felder in der Protokolldatei an. Erstellen Sie eine durch Kommas getrennte Liste mit Feld-IDs, in der die Feldreihenfolge beschrieben wird. Die Feldnamen und IDs sind in der Datei "lib/reporting/logformats/fieldlist.txt" enthalten. </li><li><p class="line891">PrimaryKey: Legen Sie diesen Primärschlüssel auf das Zeichen fest, mit dem die Protokolldateizeile als dasselbe durch "PrimaryPositions" beschriebene Format identifiziert wird. </li><li><p class="line891">SecondaryKey: Legen Sie diesen Sekundärschlüssel auf das Zeichen fest, mit dem die Protokolldateizeile als dasselbe durch "SecondaryPositions" beschriebene Format identifiziert wird. </li><li><p class="line891">PrimaryContent: TRANSACTION oder ITEM sind gültige Einträge für dieses Feld. Legen Sie diesen Eintrag auf ITEM fest, wenn sich die Treffer in Ihrer Protokolldatei jeweils auf den Kauf einzelner Produkte beziehen. Beziehen sich die Treffer in der Protokolldatei auf den gesamten Kaufvorgang, legen Sie diesen Eintrag auf TRANSACTION fest. </li><li><p class="line891">SecondaryContent: Siehe "PrimaryContent" oben. </li><li><p class="line891">CommentKey: Wenn einige Zeilen in der Protokolldatei nicht als Treffer angesehen werden und mit einem bestimmten Zeichen beginnen, geben Sie das Zeichen hier ein. </li><li><p class="line891">FieldSeparator1: Mit den FieldSeparator-Einträgen werden die als Feldtrennzeichen verwendeten Zeichen definiert. In der Regel werden Tabulator- (\t) und Leerzeichen (\s) eingegeben. Legen Sie diese Einträge anhand der Zeichen zwischen den Feldern in Ihrer Protokolldatei fest. </li><li><p class="line891">FieldSeparator2: Siehe "FieldSeparator1" oben. </li><li><p class="line891">QuotesEscapeSep: Damit wird angegeben, ob Feldtrennzeichen in einem Feld ignoriert werden, das Anführungszeichen ("") enthält. Der Eintrag YES sollte in der Regel unverändert bleiben. </li><li><p class="line891">BracketsEscapeSep: Damit wird angegeben, ob Feldtrennzeichen in einem Feld ignoriert werden, das Klammern ([]) enthält. Der Eintrag YES sollte in der Regel unverändert bleiben. </li><li><p class="line891">MergSuccessiveSep: Damit wird angegeben, ob zwei Trennzeichen in einer Zeile als ein Trennzeichen behandelt werden sollen. Der Eintrag NO kann in der Regel unverändert bleiben. </li><li><p class="line891">CleanWhiteSpace: Damit wird angegeben, ob Leerzeichen am Ende von Feldern beim Analysieren der Felder entfernt werden sollen. Der Eintrag NO kann in der Regel unverändert bleiben. </li><li><p class="line891">StatusRequired: Lassen Sie den Eintrag auf NO, sofern Ihre Treffer keine Statuscodes vom Typ Webserver enthalten. </li><li><p class="line891">CustomDateFormat: Enthält Ihr Protokollformat ein benutzerdefiniertes Datumsformat, legen Sie das entsprechende strptime-Format zur Beschreibung des Eintrags fest. </li><li><p class="line891">CustomTimeFormat: Enthält Ihr Protokollformat ein benutzerdefiniertes Zeitformat, legen Sie das entsprechende strptime-Format zur Beschreibung des Eintrags fest. </li></ul></li><li>Speichern Sie Ihr benutzerdefiniertes Protokollformat im Verzeichnis "lib/custom/logformats". </li><li>Wählen Sie das benutzerdefinierte Protokollformat für Ihre Protokollquelle in der Benutzeroberfläche von Urchin Admin aus. </li><li>Verarbeiten Sie Ihre Protokolldateien in Urchin. </li></ol></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>