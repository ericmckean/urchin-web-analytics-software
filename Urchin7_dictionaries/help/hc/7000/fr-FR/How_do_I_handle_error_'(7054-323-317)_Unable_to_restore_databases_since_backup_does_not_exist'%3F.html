<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Comment puis-je remédier à l'erreur '(7054-323-317) Impossible de restaurer les bases de données, car il n'existe aucune sauvegarde' ?</strong> <p class="line867"><strong>Description du problème</strong> <p class="line874">Vous obtenez les messages suivants lorsque vous exécutez un profil Urchin : <p class="line874">(7050-323-317) Starting automatic rollback + <p class="line874">(7054-323 317) Unable to restore databases since backup does not exist. <p class="line867"><strong>Origine</strong> <p class="line874">Cette erreur peut se produire lorsque la dernière exécution du profil Urchin concerné ne s'est pas terminée normalement ; si l'administrateur du système interrompt manuellement 'le processus ou la tâche du moteur' de traitement des journaux (à partir de l'interpréteur de commande de la console, etc.) ; si un autre problème inattendu survient provoquant l'arrêt d'un traitement de journal en cours ; ou encore si le système redémarre alors que ce processus n'est pas entièrement terminé. <p class="line874">En général, Urchin parvient à fonctionner normalement après un arrêt forcé, en restaurant la dernière version opérationnelle du profil. En revanche, si le traitement du profil est interrompu lors de la première exécution du profil en question (ou de sa première exécution pour le mois en cours), aucune sauvegarde n'est disponible pour effectuer la restauration. Urchin affiche alors le message d'erreur "Impossible de restaurer les bases de données". <p class="line874">Pour être plus précis, le moteur de traitement des journaux Urchin crée un fichier lock.udb dans le répertoire des rapports associé au profil en cours de traitement. Ce fichier reste bloqué durant la phase de traitement, afin de garantir que deux instances du moteur de traitement des journaux ne puissent pas s'exécuter simultanément pour un même profil. Lors de son démarrage, le moteur de traitement des journaux vérifie qu'aucun fichier lock.udb n'est présent. Si ce fichier existe, le moteur de traitement des journaux recherche les derniers enregistrements effectués. S'il n'en trouve pas, cela signifie que la dernière exécution du profil a échoué. Le moteur de traitement des journaux tente alors de restaurer la dernière version opérationnelle des bases de données du profil. En l'absence d'archives de sauvegarde, les messages d'erreur relatifs aux restaurations mentionnés plus haut s'affichent et le traitement des journaux est interrompu. <p class="line867"><strong>Solution</strong> <p class="line874">En raison de l'interruption anormale de la précédente exécution d'Urchin, les bases de données Urchin du mois à traiter sont associées à un état inconnu et les données qu'elles contiennent n'ont pas été confirmées de façon appropriée. Par conséquent, vous devez supprimer toutes les données relatives au mois à traiter. Dans la plupart des cas, il s'agit uniquement des données Urchin générées lors du traitement avorté pour le mois en question, elles ne renferment donc aucune information importante. <p class="line874">Procédez comme suit pour réinitialiser les données du profil Urchin et continuer de l'utiliser : <p class="line867"><span class="u">Windows Systems</span> <ol type="1"><li><p class="line862">Ouvrez un interpréteur de commande DOS Shell (Démarrer -&gt; Exécuter -&gt; "cmd") </li><li>Ouvrez le dossier dans lequel les données de profil Urchin sont stockées. En général : <ul><li style="list-style-type:none">C:\Program Files\Urchin\data\reports\profilename </li></ul></li><li>Affichez le contenu du fichier lock.udb via la commande "TYPE lock.udb". Une ou plusieurs lignes doivent comporter des dates du type YYYYMM, 200408 par exemple. </li><li>Pour chaque ligne YYYYMM du fichier lock.udb, suivez la procédure ci-dessous : <ul><li>Supprimez les bases de données mensuelles Urchin correspondantes à l'aide de la commande "DEL YYYYMM-*data*". </li><li>Pour chaque mois, vérifiez la présence d'archives de sauvegarde en utilisant la commande "DIR YYYYMM*backup*.zip". Les archives de sauvegarde sont nommées selon le modèle suivant YYYYMM-backup-YYYYMMDDHHMMSS.zip, 200805-backup-20080331103340.zip par exemple. </li><li>Si vous disposez d'un ou plusieurs fichiers de sauvegarde pour un mois donné, restaurez les données des archives de sauvegarde les plus récentes via la commande "..\..\..\util\unzip -o -u backupfile.zip", "..\..\..\util\unzip -o -u 200805-backup-20080331103340.zip" par exemple. </li></ul></li><li>Supprimez le fichier lock.udb à l'aide de la commande "DEL lock.udb". </li><li>Vous pouvez de nouveau exécuter ce profil en cliquant sur le bouton Exécuter. </li></ol><p class="line867"><span class="u">Systèmes de type UNIX</span> <ol type="1"><li>Lancez un interpréteur de commande en tant qu'administrateur "root" ou avec l'utilisateur avec lequel Urchin s'exécute. </li><li>Ouvrez le dossier dans lequel les données du profil Urchin sont stockées. Par exemple : <ul><li style="list-style-type:none">"cd /usr/local/urchin/data/reports/profilename" </li></ul></li><li>Affichez le contenu du fichier lock.udb via la commande "cat lock.udb". Une ou plusieurs lignes doivent comporter des dates du type YYYYMM, 200803 par exemple. </li><li>Pour chaque ligne YYYYMM du fichier lock.udb suivez la procédure ci-dessous : <ul><li>Supprimez les bases de données mensuelles Urchin correspondantes à l'aide de la commande "rm YYYYMM-*data*". </li><li>Pour chaque mois, vérifiez la présence d'archives de sauvegarde en utilisant la commande <ul><li style="list-style-type:none">"ls YYYYMM*backup*.zip". Les archives de sauvegarde sont nommées selon le modèle suivant YYYYMM-backup-YYYYMMDDHHMMSS.zip, 200805-backup-20080331103340.zip par exemple. </li></ul></li><li>Si vous disposez d'un ou plusieurs fichiers de sauvegarde pour un mois donné, restaurez les données des archives de sauvegarde les plus récentes via la commande "../../../util/unzip -o -u backupfile.zip", "../../../util/unzip -o -u 200803-backup-20080331103340.zip" par exemple. </li></ul></li><li>Supprimez le fichier lock.udb à l'aide de la commande "rm lock.udb". </li><li>Vous pouvez de nouveau exécuter ce profil en cliquant sur le bouton Exécuter. </li></ol></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>