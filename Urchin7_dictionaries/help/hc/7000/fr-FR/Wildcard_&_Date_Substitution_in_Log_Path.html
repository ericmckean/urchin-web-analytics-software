<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Substitution de la date et de l'heure par des caractères génériques dans le chemin du journal</strong> <p class="line867"><strong>Présentation</strong> <p class="line874">Urchin vous permet de spécifier des variables dans le chemin d'accès d'un fichier journal à l'aide de caractères génériques et de correspondances de date. Lors de l'exécution d'une tâche, Urchin lit le chemin du journal, convertit ces variables et recherche des correspondances dans les noms de fichier et répertoires de votre système. <p class="line874">Les fonctions de mise en correspondance des dates dans Urchin 6 sont plus avancées que celles proposées dans les précédentes versions d'Urchin : <ul><li>La substitution de la date peut intervenir n'importe où dans le chemin d'accès au fichier journal. Les anciennes versions d'Urchin n'effectuaient la substitution que dans le nom du fichier. </li><li>L'algorithme de mise en correspondance des données offre davantage de possibilités et de souplesse, et prend en charge l'ancien format YYYYMMDD de mise en correspondance pour garantir la compatibilité avec les anciennes versions du logiciel. </li></ul><p class="line874">Les variables et formats de mise en correspondance les plus courants vous sont présentés ci-après. Vous trouverez la liste complète des variables de format de date prises en charge à la fin de cet article. <p class="line874">* : un astérisque correspond à zéro ou à plusieurs caractères successifs. DD est remplacé par le jour du mois à 2 caractères numériques, de 01 à 31. %d équivaut à DD. MM est remplacé par le mois à 2 caractères numériques, de 01 à 12. %m équivaut à MM. YY est remplacé par l'année à 2 caractères numériques, de 01 à 99. YYYY est remplacé par l'année à 4 caractères numériques, 0001 ou 2003 par exemple. %Y équivaut à YYYY. <p class="line874">Notez que l'astérisque agit ici comme les mises en correspondance de nom de fichier des interpréteurs de commande sous UNIX ou DOS, non comme une correspondance d'expression rationnelle dans laquelle ce caractère représente zéro ou plusieurs occurrences du caractère qui le précède. L'utilisateur peut combiner toutes ces variables comme il l'entend. <p class="line874">Les exemples ci-dessous montrent comment les occurrences de ces variables seraient interprétées le 13/08/2003. Notez que les variables du jour (DD et %d) indiquent la veille du 13 une fois converties. <ul><li>YYYYMMDD devient 20030812 </li><li>%Y-%m-%d devient 2003-08-12. </li><li>%Y/%m/%d devient 2003/08/12 (notez que cette formulation a une incidence sur le chemin d'accès). </li><li>*YYYYMMDD correspond à tout nom de fichier se terminant par la chaîne 20030812.  </li></ul><p class="line874">Les variables du jour (DD et %d) sont converties par défaut à la date du jour précédent en raison de la manière dont les journaux de serveur Web et le traitement Urchin sont habituellement gérés. Généralement, la rotation de vos fichiers journaux est effectuée quotidiennement afin que leur volume reste limité et que chacun d'eux comprennent uniquement les données relatives à une journée précise. La plupart du temps cette rotation intervient juste avant minuit et Urchin débute son traitement après minuit, lorsque l'horloge est passée au jour suivant. Si vous ajoutez un horodatage de type YYYYMMDD à vos fichiers journaux lors de la rotation, il y a un jour de décalage entre cette date et l'exécution d'Urchin. Si Urchin utilise le jour auquel il s'exécute pour convertir la date, il n'est pas en mesure de trouver le nom de journal approprié, puisque le journal en question est horodaté au 20030812, tandis qu'Urchin s'exécute le 20030813. <p class="line874">Ce modèle de gestion des journaux est le plus couramment utilisé, mais il existe d'autres possibilités. Ainsi, Urchin fournit un paramètre de configuration contrôlant la manière dont les variables sont résolues pour un jour donné. Vous pouvez utiliser le paramètre Substitution de la date et de l'heure par des caractères génériques dans le nom du chemin d'accès au journal pour décaler la date associée aux variables DD et %d. Ce paramètre est expliqué en détail à la fin de cet article. <p class="line874">Les variables de l'année, du mois et du jour peuvent être utilisées soit dans le nom du fichier journal, soit dans le chemin d'accès ou le répertoire/dossier de ce fichier. En revanche, l'astérisque peut uniquement intervenir dans la portion du chemin d'accès correspondant au nom du fichier journal. De même, les variables de format de l'heure peuvent apparaître plusieurs fois dans le chemin d'accès à la source du journal, mais l'astérisque ne peut être utilisé qu'une seule fois. Les exemples mentionnés dans la section Procédure ci-après permettront de clarifier ce point. <p class="line867"><strong>Procédure</strong> <p class="line874">Lorsque vous créez ou modifiez une source de journal, vous devez utiliser des variables de temps dans le chemin spécifié dans le champ Chemin d'accès au fichier journal de l'onglet Paramètres du journal. Habituellement, la rotation des journaux réalisée par les serveurs Web Apache crée un journal à l'aide d'un horodatage indiquant la date des entrées du journal. Par exemple, une minute après minuit le 16/07/2002, le mécanisme de rotation des journaux archive le journal suivant : <pre>/var/log/httpd/access.log
</pre><p class="line874">qu'il enregistre sous le nom suivant : <pre>/var/log/httpd/access.log.20020715
</pre><p class="line874">La source de journal du profil Urchin profil doit donc être associée au format suivant : <pre>/var/log/httpd/access.log.YYYYMMDD
</pre><p class="line874">dans le champ Chemin d'accès au fichier journal de sorte qu'Urchin recherche automatiquement le journal de la veille. De même, lorsqu'un serveur IIS Microsoft réalise une rotation quotidienne des journaux, il inclut la date du jour dans le nom du fichier journal enregistré, ex021127.log par exemple. Si vous souhaitez traiter un journal IIS quotidien, vous devrez spécifier votre fichier journal de la manière suivante : <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD.log
</pre><p class="line874">dans le champ Chemin d'accès au fichier journal correspondant à la Source du journal dans le profil concerné. <p class="line874">Pour qu'Urchin puisse traiter des journaux dont la fréquence de rotation est supérieure à un jour, vous pouvez combiner la syntaxe YYYYMMDD et des caractères génériques établissant une correspondance avec tous les fichiers journaux créés la veille. Pour ce faire, assurez-vous que les fichiers journaux enregistrés sont nommés de façon cohérente. Si l'heure d'enregistrement est incluse dans le nom de fichier par exemple, vous pouvez utiliser un format similaire aux suivants pour spécifier le Chemin d'accès au fichier journal : <pre>/var/log/httpd/access.log.YYYYMMDD*
</pre><p class="line874">ou <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD*.log
</pre><p class="line874">Certaines situations peuvent nécessiter un mode d'utilisation plus complexe, notamment lorsque les journaux sont stockés selon une arborescence de répertoires représentant l'année, le mois et le jour. Supposons que vous utilisiez les répertoires suivants pour stocker vos journaux : <pre>/logs/2003/07
/logs/2003/08
/logs/2003/09
</pre><p class="line874">et que tous les journaux relatifs à un mois donné soient enregistrés dans leur répertoire respectif, chaque nom de journal précisant le jour du mois correspondant (access.log.01, access.log.02, etc.). Vous devez alors utiliser l'un des formats suivants pour indiquer à Urchin les fichiers journaux à traiter : <pre>/logs/YYYY/MM/access.log.DD
/logs/%Y/%M/access.log.%d
</pre><p class="line874">Le moment venu, Urchin traitera tous les journaux dont le format correspond à la date d'hier, quel que soit le suffixe. Si vous utilisez ce caractère générique dans le champ Chemin d'accès au fichier journal ou tout autre caractère générique, veillez à activer le Suivi du journal dans le Profil associé, afin qu'Urchin ne retraite pas les journaux. <p class="line867"><strong>Considérations</strong> <p class="line874">Pour déterminer la date de remplacement, Urchin soustrait 24 heures à la date courante, heure locale. Le programme peut ensuite associer correctement le mois et l'année. Toutefois, vous pouvez modifier ce fonctionnement à l'aide du paramètre Substitution de la date et de l'heure par des caractères génériques dans le nom du chemin d'accès au journal, sous l'onglet Paramètres avancés de la source du journal. Sélectionnez Heure locale ou Heure GMT comme base d'ajustement, puis définissez un décalage horaire positif ou négatif dans le champ Heures. <p class="line867"><strong>Liste exhaustive des références aux formats de date et d'heure</strong> <p class="line874">Voici la liste complète des variables de format d'horodatage prises en charge. Ces variables respectent les conventions utilisées par la fonction strftime() de la bibliothèque standard de C : <ul><li>%A = désignation nationale complète du jour de la semaine. </li><li>%a = désignation nationale abrégée du jour de la semaine. </li><li>%B = désignation nationale complète du mois. </li><li>%b = désignation nationale abrégée du mois. </li><li>%d = jour du mois représenté par un numéro de 01 à 31. </li><li>%e = jour du mois représenté par un numéro de 1 à 31, les numéros à un chiffre sont précédés d'un espace. </li><li>%H = l'heure (sur 24 heures) représentée par un numéro de 00 à 23. </li><li>%I = l'heure (sur 12 heures) représentée par un numéro de 01 à 12. </li><li>%j = jour de l'année représenté par un numéro de 001 à 366. </li><li>%k = l'heure (sur 24 heures) représentée par un numéro de 0 à 23, les numéros à un chiffre sont précédés d'un espace. </li><li>%l = l'heure (sur 12 heures) représentée par un numéro de 1 à 12, les numéros à un chiffre sont précédés d'un espace. </li><li>%M = les minutes représentées par un numéro de 00 à 59. </li><li>%m = le mois représenté par un numéro de 01 à 12. </li><li>%p = désignation nationale de "ante meridiem" ou "post meridiem", selon. </li><li>%S = les secondes représentées par un numéro de 00 à 60. </li><li>%s = le nombre de secondes écoulées depuis la date Epoch, UTC (voir la fonction mktime(3)). </li><li>%w = le jour de la semaine (le premier jour de la semaine étant dimanche) représenté par un numéro de 0 à 6. </li><li>%Y = l'année représentée par un numéro, siècle inclus. </li><li>%y = l'année représentée par un numéro de 00 à 99, sans indication du siècle. </li><li>%z = le décalage horaire par rapport à l'UTC, précédé d'un signe plus pour indiquer l'Est de l'UTC ou d'un signe moins pour indiquer l'Ouest; suivi de l'heure et des minutes à deux chiffres chacune et sans séparateur (forme courante selon la documentation RFC 822 sur les en-têtes de date). </li><li>%% = `%'. à utiliser lorsque le signe % lui-même est requis dans une entrée date/heure.  </li></ul></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>