<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Comment puis-je déplacer Urchin 6.x et toutes les données de rapport sur un autre serveur ?</strong> <p class="line874">Pour déplacer Urchin 6.x d'un serveur à un autre, vous devez procéder comme suit. <ol type="1"><li>Préparer la base de données Urchin </li><li>Installer Urchin 6.x sur le nouveau serveur </li><li>Déplacer les bases de données Urchin de création de rapports associées aux profils </li><li>Déplacer les fichiers et modèles personnalisés </li><li>Appliquer à Urchin vos paramètres personnalisés </li><li>Vérifier les nouvelles autorisations d'accès aux fichiers </li><li>Réactiver la licence Urchin </li></ol><p class="line874">REMARQUE : Les instructions détaillées ci-après peuvent être appliquées à des déplacements impliquant plusieurs plates-formes. Vous pouvez déplacer les fichiers de base de données Urchin de création de rapports vers tout système d'exploitation pris en charge par Urchin. Lors d'un déplacement de fichiers et de données d'un type de plate-forme à un autre, vous devez notamment veiller à respecter la syntaxe des lignes de commande (ajout de "./" pour les systèmes Unix), ainsi que la syntaxe des chemins d'accès : "Dossiers\Windows\standard\" contre "/répertoires/unix/standard/". <p class="line867"><strong>1. Préparer la base de données Urchin</strong> <p class="line874">Passez cette étape si votre nouvelle installation Urchin utilise le même serveur de base de données que précédemment. Dans le cas contraire, vous devez préparer la base de données Urchin avant de procéder à l'installation sur le nouveau serveur : <p class="line867"><strong>a.</strong>      Créez une base de données Urchin vide avec les autorisations requises pour l'utilisateur Urchin. <p class="line874">Exemple de commandes SQL permettant de créer une base de données MySQL principale : <p class="line867"><pre>   mysql&gt; create database urchin character set utf8;
   mysql&gt; GRANT ALL ON urchin.* to 'urchin'@'localhost' IDENTIFIED BY 'urchinpassword';
</pre><p class="line874">Exemple de commandes PSQL permettant de créer un base de données PostgreSQL principale : <p class="line867"><pre>   postgres=# CREATE DATABASE urchin WITH ENCODING 'UTF8';
   postgres=# CREATE USER urchin WITH PASSWORD 'urchin password';
   postgres=# GRANT ALL ON DATABASE urchin TO urchin;
   postgres=# \connect urchin;
   postgres=# CREATE LANGUAGE 'PLPGSQL';
</pre><p class="line867"><strong>b.</strong>      Copiez la base de données Urchin de l'ancien serveur en créant une image SQL de celle-ci afin de l'importer dans la nouvelle base de données. Cela copie automatiquement l'essentiel de la configuration Urchin, notamment les profils, sources de journal, utilisateurs, comptes, groupes, tâches de planificateur et autres paramètres. <p class="line874">Exemple de commandes SQL pour une base de données MySQL principale : <ul><li style="list-style-type:none">Base de données source : </li></ul><p class="line867"><pre>   mysqldump -h {oldDBhostname} -u {username} -p {urchinDBname} &gt; urchin.sql
</pre><ul><li style="list-style-type:none">Base de données de destination : </li></ul><p class="line867"><pre>   mysql -h {newDBhostname} -u {username} -p {urchinDBname} &lt; urchin.sql
</pre><p class="line874">Exemple de commandes PSQL pour une base de données PostgreSQL principale : <ul><li style="list-style-type:none">Base de données source : </li></ul><p class="line867"><pre>   pg_dump -h {oldDBhostname} -p {oldDBport} -U {username} {urchinDBname} &gt; urchin.sql
</pre><ul><li style="list-style-type:none">Base de données de destination : </li></ul><p class="line867"><pre>   psql -h {newDBhostname} -p {newDBport} -U {username} {urchinDBname} &lt; urchin.sql
</pre><p class="line867"><strong>2. Installer Urchin 6.x sur le nouveau serveur</strong> <p class="line874">Créez une installation d'Urchin 6 sur le nouveau serveur avec la base de données préparée plus haut. <p class="line874">Veillez à ne pas cocher la case d'option "Supprimer et recréer les tables de base de données spécifiques à Urchin si elles existent" pour une installation Windows ou à répondre NON à la question "Voulez-vous initialiser les bases de données de configuration au cours de l'installation ?" pour une installation Unix ! <p class="line874">Vous trouverez ici des instructions détaillées sur l'installation d'Urchin (passez directement au chapitre "Installation d'Urchin" sans effectuer la procédure de configuration de la base de données) : <ul><li><p class="line891"><a href="Urchin_Installation_Guide_(FreeBSD_and_Linux).html">Urchin - Guide d'installation (FreeBSD et Linux)</a> </li><li><p class="line891"><a href="Urchin_Installation_Guide_(Windows).html">Urchin - Guide d'installation (Windows)</a> </li></ul><p class="line874">Arrêtez les démons ou services urchin avant de passer à l'étape suivante : <p class="line867"><pre>~/urchin/bin/urchinctl -stop
</pre><p class="line867"><strong>3. Déplacer les bases de données Urchin de création de rapports associées aux profils</strong> <p class="line874">Par défaut, toutes les données Urchin liées à la création de rapports sont stockées dans un sous-répertoire du répertoire Urchin : ~/urchin/data/. Ce dernier doit être archivé afin de conserver la structure du sous-répertoire, puis déplacé vers le nouveau serveur après l'installation d'Urchin. Il doit être restauré dans le même emplacement sur le nouveau serveur lorsque cela est possible : ~/urchin/data. <p class="line874">REMARQUE : Si votre ancienne installation d'Urchin faisait appel à des répertoires personnalisés pour l'historique et les rapports, utilisez ces répertoires en lieu et place de ~/urchin/data/reports et ~/urchin/data/history. <p class="line867"><strong>4. Déplacer les fichiers et modèles personnalisés</strong> <p class="line874">Les personnalisations apportées à Urchin, notamment les formats de journaux personnalisés et les ensembles de rapports, ne sont pas conservées dans le répertoire "data". Ces personnalisations sont stockées dans un emplacement distinct du répertoire "lib" de la distribution Urchin. Une fois Urchin installé sur votre nouveau serveur, vous devez y copier les modifications apportées à votre ancien système Urchin. Ces fichiers sont généralement stockés dans le répertoire ~/urchin/lib/custom/. <p class="line874">Pour ce faire, accédez à l'ancien serveur Urchin et ouvrez le répertoire "lib" de la distribution Urchin. Ensuite, compressez le répertoire "custom" (sous-répertoires y compris) à l'aide d'un utilitaire tel que tar ou ZIP. Copiez le fichier compressé sur votre nouveau serveur Urchin afin de l'extraire dans le répertoire "lib" de votre distribution Urchin. <p class="line867"><strong>5. Appliquer à Urchin vos paramètres personnalisés</strong> <p class="line874">Si vous avez modifié les paramètres par défaut de votre ancienne installation Urchin 6.x dans les répertoires : <p class="line867"><pre>/etc/session.conf
/etc/urchin.conf
/var/urchinwebd.conf
</pre><p class="line874">n'oubliez pas d'appliquer ces mêmes paramètres à votre nouvelle installation en modifiant les fichiers concernés. <p class="line867"><strong>6. Vérifier les nouvelles autorisations d'accès aux fichiers</strong> <p class="line874">Après avoir déplacé tous vos fichiers sur le nouveau serveur, vous devez vous assurer que chacun d'eux est associé aux autorisations appropriées et que ces fichiers appartiennent tous au même utilisateur (systèmes UNIX seulement). <p class="line874">Pour corriger les autorisations Urchin, exécutez la commande suivante dans le répertoire ~/urchin/util/ : <p class="line867"><pre>        inspector -r
</pre><p class="line874">Pour vérifier la propriété des fichiers (UNIX seulement) exécutez la commande suivante dans le répertoire ~/urchin/ : <p class="line867"><pre>        chown -R urchin_user:urchin_group ./
</pre><p class="line867"><strong>7. Réactiver la licence Urchin</strong> <p class="line874">Démarrez les démons et services urchin. <p class="line867"><pre>~/urchin/bin/urchinctl start
</pre><p class="line874">Une fois l'installation d'Urchin terminée, ouvrez l'interface Web du logiciel. <p class="line874">Le système affiche alors l'écran "Licence Urchin" contenant le lien "Réactiver la licence". <p class="line874">Urchin a été installé avec la base de données précédemment préparée, par conséquent la clé système a changé et vous devez réactiver la licence. <p class="line874">REMARQUE : Veuillez demander à votre revendeur Urchin de réinitialiser votre licence avant de la réactiver. </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>