<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Meilleures pratiques pour la rotation des journaux</strong> <p class="line867"><strong>Présentation</strong> <p class="line874">Dans la grande majorité des environnements, les actions et événements liés aux services et applications du système, comme les serveurs Web, sont consignés dans des fichiers journaux. En général, les systèmes d'exploitation et/ou les applications comprennent également des fonctions de maintenance des fichiers journaux permettant de contrôler la taille de ces fichiers. Cela restreint leur croissance et par conséquent la place qu'ils occupent sur le disque. <p class="line874">La méthode la plus courante pour gérer les fichiers journaux consiste à créer une tâche de rotation régulière qui renomme automatiquement les fichiers journaux en cours à l'aide d'un horodatage, puis redémarre le service ou l'application avec un fichier journal vide. Généralement, cette tâche de rotation gère également la compression des anciens fichiers journaux, puis leur suppression après une période donnée ou à la fin d'un cycle de rotations. <p class="line874">Dans le cas particulier des journaux de serveur Web, la rotation est souvent effectuée quotidiennement pour conserver une taille de fichier adaptée. De plus, la stratégie de rotation quotidienne des journaux de serveur Web offre une précision accrue qui facilite le traitement a posteriori avec des outils d'analyse tel qu'Urchin. Par exemple, les serveurs Web IIS de Microsoft disposent d'une fonctionnalité intégrée qui, lorsqu'elle est activée, effectue par défaut une rotation quotidienne des journaux. D'autres serveurs Web, notamment Apache, ne fournissent pas de gestionnaire de rotation des journaux, mais des outils facilitant le redémarrage du serveur Web (sans interruption du service) afin de réaliser la rotation (apachectl restart par exemple). <p class="line867"><strong>Méthodes de rotation des journaux</strong> <p class="line874">Grâce à la technologie Urchin de suivi du journal, vous n'avez plus besoin d'effectuer la rotation des journaux pour éviter un double traitement des journaux. Cela apporte à Urchin une flexibilité accrue dans le traitement des journaux, avec notamment la possibilité d'analyser des journaux "en ligne" dans lesquels le serveur Web écrit en continu, ou de traiter des journaux dont la rotation est effectuée manuellement ou de façon irrégulière. <p class="line867"><strong>Remarque importante :</strong> Contrairement aux versions précédentes d'Urchin, Urchin 6 ne fournit aucun outil permettant d'appeler une procédure de rotation des journaux ou de redémarrer le serveur Web une fois les tâches de rotation effectuées. Cependant, les opérations décrites ci-après peuvent être réalisées à la suite d'un traitement. <p class="line874">Même si Urchin 6 ne requiert pas de rotation des journaux, il est recommandé de mettre en œuvre une stratégie de rotation des journaux afin de garantir un fonctionnement optimal du programme et d'éviter que l'utilitaire de suivi du journal traite inutilement de gros volumes de données. Du point de vue du système comme de l'application, il est plus judicieux de traiter de nombreux journaux de petite taille que de traiter un journal très volumineux. En effet, l'analyse des fichiers ralentit de manière significative lorsque la taille du fichier augmente. En outre, les petits fichiers sont faciles à sauvegarder et à restaurer en cas de défaillance du disque ou du système. <p class="line874">Les mécanismes de rotation des journaux ne sont pas nécessairement d'une complexité insurmontable. En général, un simple script shell ou Perl exécuté quotidiennement sur des systèmes de type UNIX à partir du programme cron est suffisant. Le script doit simplement effectuer la rotation du journal de serveur Web en cours en y ajoutant un horodatage (la variable %Y%m%d ou le format AAAAMMJJ sont recommandés), puis redémarrer le serveur Web. Vous pouvez également définir une fonction permettant d'éliminer les anciens fichiers journaux et de contrôler votre utilisation de l'espace disque.  <p class="line867"><strong>Configuration d'Urchin en vue de la rotation des journaux</strong> <p class="line862">Une fois votre stratégie de rotation des journaux mise en place, il ne reste qu'à configurer le logiciel Urchin de sorte qu'il traite les fichiers journaux ainsi enregistrés. Vous pouvez soit définir le Chemin d'accès au fichier journal à l'aide d'un caractère générique correspondant au format du nom de fichier journal horodaté lorsque vous configurez une Source du journal (par exemple, access-log.* pour des journaux Apache ou ex*.log pour des journaux IIS), soit utiliser la correspondance de format intégrée dans Urchin (à savoir access-log.%Y%m%d pour Apache et ex%y%m%d.log pour IIS). Si Urchin rencontre ce format, il remplace la chaîne %Y%m%d par la date de la veille et traite le journal en indiquant le nom de fichier ainsi obtenu (access-log.20020617, par exemple). Pour plus d'informations sur la correspondance de format des dates, consultez la rubrique Substitution de la date et de l'heure par des caractères génériques dans le chemin du journal. <p class="line874">L'utilisation de caractères génériques vous permet de placer plusieurs journaux non traités dans un même répertoire et de les faire analyser par Urchin à la prochaine exécution du programme. Cette méthode s'avère pratique lorsque les fichiers journaux attendus ne sont pas disponibles au lancement d'Urchin, en raison d'une panne sur un serveur distant ou de la perte d'une connexion réseau par exemple. L'inconvénient étant qu'Urchin doit analyser tous les fichiers journaux du répertoire pour déterminer s'ils ont déjà été traités. Cette opération peut entraîner une surcharge lorsque les fichiers journaux enregistrés dans le répertoire sont nombreux. Si vous pensez que votre stratégie de rotation des journaux est fiable, la méthode des correspondances de format AAAAMMJJ sera plus efficace. <p class="line862">Vous pouvez également faire en sorte qu'Urchin 6 supprime ou archive/compresse les journaux traités. Les Paramètres avancés de la Source du journal offrent différentes options pour définir l'Avenir du journal. Pour plus d'informations sur les paramètres de l'option Avenir du journal, consultez la rubrique Gestion des fichiers journaux. <p class="line867"><strong>Important !</strong> N'utilisez pas l'option Avenir du journal avec les journaux en ligne qui ne font l'objet d'aucune rotation ! <p class="line867"><strong>Configuration de la rotation des journaux sur des systèmes de type UNIX</strong> <p class="line874">En raison de la grande variété de fonctionnalités et de serveurs Web utilisés sur les systèmes d'exploitation de type UNIX et de la forte probabilité pour que les procédures de rotation des journaux soient tout à fait spécifiques à chaque site, il n'existe pas de recette miracle commune à tous ces systèmes pour configurer la rotation des journaux de serveur Web.  <p class="line867"><strong>Configuration de la rotation des journaux sur un serveur Web Windows IIS</strong> <p class="line874">Comme indiqué précédemment, les fonctions de gestion d'IIS permettent d'automatiser la rotation des journaux de serveur Web, mais cette fonctionnalité n'est pas activée par défaut. Veuillez suivre les étapes de configuration ci-dessous pour gérer la rotation des journaux sur un serveur Web IIS. Nous vous recommandons d'opter pour une rotation quotidienne exécutée en fonction de l'heure locale. Par défaut, IIS effectue la rotation des journaux à minuit GMT et non à l'heure locale. <p class="line874">Sous Windows 2000, assurez-vous que le serveur Web IIS est configuré de manière appropriée pour la rotation des journaux. Pour cela, utilisez la fonction Gestion de l'ordinateur de Windows 2000. Windows NT, Windows XP et Windows Server 2003 font appel à une procédure similaire. Pour accéder à la Gestion de l'ordinateur et définir la rotation des journaux, procédez comme suit : <ul><li><p class="line862">Cliquez sur Démarrer -&gt; Paramètres -&gt; Panneau de configuration. </li><li>Double-cliquez sur Outils d'administration. </li><li>Double-cliquez sur Gestion de l'ordinateur. </li><li>Double-cliquez sur Services Internet (IIS). </li><li>Cliquez avec le bouton droit sur Site Web par défaut et sélectionnez Propriétés. </li><li>Dans la fenêtre qui apparaît, ouvrez l'onglet Site Web. </li><li>Ouvrez l'onglet Propriétés au bas de la fenêtre. </li><li>Cochez l'option Quotidienne dans la section Nouvelle durée de journalisation. </li><li>Cochez la case Utiliser l'heure locale pour la désignation et la substitution du fichier. </li></ul><p class="line874">De cette manière, IIS réalise la rotation des journaux Web quotidiennement, juste après minuit. </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>