<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Journaux E-commerce personnalisés</strong> <p class="line867"><strong>Présentation</strong> <p class="line862">De nombreux paniers électroniques permettent d'enregistrer et de consigner des informations importantes sur les achats effectués, mais ils n'utilisent pas le format ELF2. C'est pourquoi Urchin n'est pas en mesure de les traiter automatiquement. Cet article vous indiquera comment créer un format personnalisé pour votre fichier journal E-commerce, si vous ne parvenez pas à modifier votre panier électronique de sorte qu'il génère un format ELF2. Avant de continuer, lisez la rubrique <a href="Custom_Log_Formats.html">Formats de journaux personnalisés</a> qui décrit de façon détaillée la création de journaux personnalisés. <p class="line867"><strong>Les différents formats des journaux E-commerce</strong> <p class="line874">Pour consigner les données relatives à un achat et à l'article associé, les paniers électroniques peuvent utiliser deux formats : l'un sur une ligne unique, l'autre sur plusieurs lignes. Le premier format réunit sur une ligne toutes les informations nécessaires pour décrire une transaction et les articles achetés, toutes les lignes étant présentées de la même manière. Le second format utilise plusieurs lignes pour décrire un achat, un format pour les lignes de transaction et un autre pour les articles achetés. Le format ELF2 appartient à la catégorie multiligne. Vous devez à présent déterminer le format de vos journaux E-commerce, à une ou plusieurs lignes, afin de savoir comment poursuivre la configuration de votre format de journal personnalisé. Ensuite, appliquez l'une des procédures ci-dessous selon le format de vos journaux. <p class="line867"><strong>Conditions d'ordre général requises pour la journalisation E-commerce</strong> <p class="line874">Quel que soit le format des entrées de journal produites par votre panier électronique, chaque entrée doit inclure la date, l'heure et au moins l'une des informations suivantes afin de pouvoir établir des corrélations avec les visiteurs : <ul><li>Hôte distant ou adresse IP (méthode de suivi des visiteurs IP uniquement ou IP + User-Agent) </li><li>User-Agent (méthode de suivi des visiteurs IP + User-Agent) </li><li>Cookies (méthode de suivi des visiteurs UTM ou SID, ID de session) </li><li>ID de session (méthode de suivi des visiteurs SID) </li></ul><p class="line874">Si vous omettez l'un des champs mentionnés ci-dessus, Urchin ne pourra pas produire d'analyse de revenus significative. Urchin définit également les champs E-commerce suivants : <ul><li>%{ORDERID} représente le numéro de commande. </li><li>%{STORE} représente le nom/l'identifiant de l'enseigne. </li><li>%{SESSIONID} représente l'identifiant de session unique du client. </li><li>%{TOTAL} représente le montant total de la transaction, taxes et expédition comprises (nombre décimal uniquement, pas de '$'). </li><li>%{TAX} représente le montant des taxes à ajouter au sous-total. </li><li>%{SHIPPING} représente le montant des frais d'expédition. </li><li>%{BILL_CITY} représente la ville de facturation associée au client. </li><li>%{BILL_STATE} représente le département de facturation associé au client. </li><li>%{BILL_ZIP} représente le code postal de facturation associé au client. </li><li>%{BILL_COUNTRY} représente le pays de facturation associé au client. </li><li>%{PRODUCT_CODE} représente la référence du produit. </li><li>%{PRODUCT_NAME} représente le nom du produit. </li><li>%{VARIATION} représente une variante facultative du produit : couleur, taille, etc. </li><li>%{PRICE} représente le prix unitaire du produit (nombre décimal uniquement, pas de '$'). </li><li>%{QUANTITY} représente la quantité de produits commandée. </li><li>%{UPSOLD} représente une valeur booléenne (0|1) indiquant si le produit était en réduction. </li></ul><p class="line867"><strong>Format de journal de type ligne unique</strong> <p class="line874">Suivez les instructions ci-après si votre fichier journal E-commerce comprend des entrées possédant toutes un format de ligne similaire à celui décrit précédemment. <ol type="1"><li>Créez un format de journal personnalisé dans le répertoire lib/custom/logformats en y copiant le fichier custom.lf.sample. Le nom de votre copie doit inclure le suffixe .lf. </li><li>Modifiez votre fichier de format de journal et définissez les entrées suivantes en fonction des recommandations indiquées : <ul><li><p class="line891">PrimaryPositions : cette entrée décrit l'ordre des champs dans votre fichier journal. Créez une liste d'identifiants de champ séparés par des virgules, dans l'ordre souhaité. Les noms et identifiants de champ sont répertoriés dans le fichier lib/reporting/logformats/fieldlist.txt. Voir l'exemple ci-après. </li><li><p class="line891">SecondaryPositions : conservez le '-', car cette entrée n'est pas utilisée dans les fichiers de format de journal de type multiligne. </li><li><p class="line891">PrimaryKey : conservez le '-', car cette entrée n'est pas utilisée dans les fichiers de format de journal ligne par ligne. </li><li><p class="line891">SecondaryKey : conservez le '-', car cette entrée n'est pas utilisée dans les fichiers de format de journal ligne par ligne. </li><li><p class="line891">PrimaryContent : les entrées admises pour ce champ sont TRANSACTION et ITEM. Si votre fichier journal répertorie individuellement chaque produit acheté, utilisez ITEM. Si votre fichier journal décrit l'achat dans sa totalité, utilisez TRANSACTION. </li><li><p class="line891">SecondaryContent : conservez le '-', car cette entrée n'est pas utilisée dans les fichiers journaux de type ligne unique. </li><li><p class="line891">CommentKey : si certaines lignes de votre fichier journal correspondent à des commentaires ou ne sont pas considérées comme des entrées, et commencent par un caractère particulier, saisissez ce caractère ici. </li><li><p class="line891">FieldSeparator1 : cette entrée définit les caractères à considérer comme des séparateurs de champs. On utilise généralement des tabulations (\t) et des espaces (\s). Saisissez ici les caractères qui apparaissent entre les champs dans votre fichier journal. </li><li><p class="line891">FieldSeparator2 : voir FieldSeparator1 ci-dessus. </li><li><p class="line891">QuotesEscapeSep : cette entrée indique si les séparateurs de champs doivent être ignorés dans les champs entourés de guillemets droits (""). De manière générale, il est conseillé de conserver la valeur YES. </li><li><p class="line891">BracketsEscapeSep : cette entrée indique si les séparateurs de champs doivent être ignorés dans les champs entourés de crochets ([]). De manière générale, il est conseillé de conserver la valeur YES. </li><li><p class="line891">MergSuccessiveSep : cette entrée indique si les séparateurs en double doivent être considérés comme un seul séparateur. Vous pouvez probablement conserver la valeur NO. </li><li><p class="line891">CleanWhiteSpace : cette entrée indique si les espaces en fin de champ doivent être supprimés lors de l'analyse. Vous pouvez probablement conserver la valeur NO. </li><li><p class="line891">StatusRequired : conservez la valeur NO, à moins que vos entrées comprennent des codes d'état de type serveur Web. </li><li><p class="line891">CustomDateFormat : si le format de vos journaux contient un format de date personnalisé, définissez le format strptime approprié pour décrire cette entrée. </li><li><p class="line891">CustomTimeFormat : si le format de vos journaux contient un format d'heure personnalisé, définissez le format strptime approprié pour décrire cette entrée. </li></ul></li><li>Enregistrez votre format de journal personnalisé dans le répertoire lib/custom/logformats. </li><li>Dans l'interface Urchin Admin, sélectionnez le format de journal personnalisé à utiliser comme source. </li><li>Traitez votre ou vos fichiers journaux à l'aide d'Urchin. </li></ol><p class="line867"><strong>Exemple de format de journal de type ligne unique</strong> <p class="line874">L'exemple suivant décrit une entrée de journal comprenant une seule transaction. <p class="line867"><pre>12345 123.123.123.123 "Urchin Store" [26/Aug/2003:11:43:02 -0700] 192.73 "San Diego" "CA" 92101 "US" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;)" "utma=171060324.2734232095.1061444425.1061444425.1061444763.2"
</pre><p class="line862">La liste ci-après répertorie les noms de champ accompagnés de leur identifiant, tel qu'indiqué dans le fichier lib/reporting/logformats/fieldslist.txt. Les identifiants ainsi attribués sont utilisés dans le champ PrimaryPositions du fichier décrivant votre format de journal personnalisé. <ol type="1"><li>Identifiant de transaction 25 </li><li>Hôte distant ou adresse IP 12 </li><li>Nom du magasin 26 </li><li>Date/Heure Apache 3 </li><li>Coût total 28 </li><li>Ville de facturation 31 </li><li>Département de facturation 32 </li><li>Code postal de facturation 33 </li><li>Pays de facturation 34 </li><li class="gap">User-Agent 13 </li><li>Cookies 14 </li></ol><p class="line874">Compte tenu de la liste établie ci-dessus, vous devez définir les entrées suivantes dans le fichier de format de journal personnalisé : <p class="line867"><pre>PrimaryPositions: "25, 12, 26, 3, 28, 31, 32, 33, 34, 13, 14" SecondaryPositions: - PrimaryKey: - SecondaryKey: - PrimaryContent: TRANSACTION SecondaryContent: - CommentKey: # FieldSeparator1: \s FieldSeparator2: \t QuotesEscapeSep: YES BracketsEscapeSep: YES MergSuccessiveSep: NO CleanWhiteSpace: NO StatusRequired: NO CustomDateFormat: - CustomTimeFormat: -
</pre><p class="line862">L'entrée PrimaryPositions définit l'ordre des champs et l'entrée PrimaryContent indique à Urchin que ce journal répertorie des transactions (ou des informations générales sur les achats). Les séparateurs de champs utilisés sont l'espace et la tabulation, puisque les champs ont été séparés par des espaces. Aucun format personnalisé n'a été précisé pour la date et l'heure, car elles utilisent le format de date Apache. <p class="line867"><strong>Format de journal de type multiligne</strong> <p class="line874">Urchin prend en charge les formats multilignes, à condition que le premier caractère de chaque ligne soit spécifique et permette d'identifier le format utilisé. Dans les fichiers journaux ELF2, par exemple, toutes les lignes de transaction commencent par un point d'exclamation '!'. En revanche, les lignes relatives aux articles ne commencent JAMAIS par un point d'exclamation '!'. <p class="line874">Suivez les instructions ci-après si votre fichier journal E-commerce comprend deux types de ligne, un pour les transactions, l'autre pour les informations relatives au produit ou à l'article. <ol type="1"><li>Créez un format de journal personnalisé dans le répertoire lib/custom/logformats en y copiant le fichier custom.lf.sample. Le nom de votre copie doit inclure le suffixe .lf. </li><li>Modifiez ce nouveau fichier de format de journal et définissez les entrées suivantes en fonction des recommandations indiquées : <ul><li><p class="line891">PrimaryPositions : cette entrée décrit l'ordre des champs dans votre fichier journal. Créez une liste d'identifiants de champ séparés par des virgules, dans l'ordre souhaité. Les noms et identifiants de champ sont répertoriés dans le fichier lib/reporting/logformats/fieldlist.txt. </li><li><p class="line891">SecondaryPositions : cette entrée décrit l'ordre des champs dans votre fichier journal. Créez une liste d'identifiants de champ séparés par des virgules, dans l'ordre souhaité. Les noms et identifiants de champ sont répertoriés dans le fichier lib/reporting/logformats/fieldlist.txt. </li><li><p class="line891">PrimaryKey : saisissez ici un caractère permettant d'identifier les lignes de fichier journal correspondant au format décrit dans PrimaryPositions. </li><li><p class="line891">SecondaryKey : saisissez ici un caractère permettant d'identifier les lignes de fichier journal correspondant au format décrit dans SecondaryPositions. </li><li><p class="line891">PrimaryContent : les entrées admises pour ce champ sont TRANSACTION et ITEM. Si votre fichier journal répertorie individuellement chaque produit acheté, utilisez ITEM. Si votre fichier journal décrit l'achat dans sa totalité, utilisez TRANSACTION. </li><li><p class="line891">SecondaryContent : voir PrimaryContent ci-dessus. </li><li><p class="line891">CommentKey : si certaines lignes de votre fichier journal correspondent à des commentaires ou ne sont pas considérées comme des entrées, et commencent par un caractère particulier, saisissez ce caractère ici. </li><li><p class="line891">FieldSeparator1 : cette entrée définit les caractères à considérer comme des séparateurs de champs. On utilise généralement des tabulations (\t) et des espaces (\s). Saisissez ici les caractères qui apparaissent entre les champs dans votre fichier journal. </li><li><p class="line891">FieldSeparator2 : voir FieldSeparator1 ci-dessus. </li><li><p class="line891">QuotesEscapeSep : cette entrée indique si les séparateurs de champs doivent être ignorés dans les champs entourés de guillemets droits (""). De manière générale, il est conseillé de conserver la valeur YES. </li><li><p class="line891">BracketsEscapeSep : cette entrée indique si les séparateurs de champs doivent être ignorés dans les champs entourés de crochets ([]). De manière générale, il est conseillé de conserver la valeur YES. </li><li><p class="line891">MergSuccessiveSep : cette entrée indique si les séparateurs en double doivent être considérés comme un seul séparateur. Vous pouvez probablement utiliser la valeur NO. </li><li><p class="line891">CleanWhiteSpace : cette entrée indique si les espaces en fin de champ doivent être supprimés lors de l'analyse. Vous pouvez probablement conserver la valeur NO. </li><li><p class="line891">StatusRequired : conservez la valeur NO, à moins que vos entrées comprennent des codes d'état de type serveur Web. </li><li><p class="line891">CustomDateFormat : si le format de vos journaux contient un format de date personnalisé, définissez le format strptime approprié pour décrire cette entrée. </li><li><p class="line891">CustomTimeFormat : si format de vos journaux contient un format d'heure personnalisé, définissez le format strptime approprié pour décrire cette entrée. </li></ul></li><li>Enregistrez votre format de journal personnalisé dans le répertoire lib/custom/logformats. </li><li>Dans l'interface Urchin Admin, sélectionnez le format de journal personnalisé à utiliser comme source. </li><li>Traitez votre ou vos fichiers journaux à l'aide d'Urchin. </li></ol></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>