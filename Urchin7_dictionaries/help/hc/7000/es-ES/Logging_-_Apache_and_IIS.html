<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Registro: Apache e IIS</strong> <p class="line867"><strong>Visión general</strong> <p class="line874">Es fundamental configurar la funcionalidad de registro del servidor web en un formato que permita a Urchin interpretar correctamente los datos y producir informes detallados. En este artículo se explica el procedimiento de los servidores web más habituales: Apache y Microsoft IIS. Para obtener un informe más detallado, es importante configurar la función de registro para que incluya información de referencia y de user agent. Para activar los informes de usuario único al utilizar el Módulo de seguimiento de Urchin (UTM), es necesario activar también el registro de cookies. El seguimiento basado en UTM es la única forma de obtener informes de usuario único auténticos. Aunque no es necesario, se recomienda que decida si desea utilizar UTM antes de cambiar el registro de su servidor web. Si es así, deberá activar ahora las cookies de sus registros. La activación de cookies no tiene consecuencias negativas, pero no instale UTM en su sitio web de forma inmediata. Antes, le recomendamos que consulte la sección Seguimiento de los usuarios del sitio para familiarizarse con la instalación de UTM. <p class="line867"><strong>Configuración</strong> <p class="line867"><strong>Apache</strong> <p class="line874">De forma predeterminada, Apache realiza el registro en el denominado "formato de registro común" y ofrece una opción para hacerlo en un formato más detallado conocido como "formato de registro extendido/combinado NCSA". Para conseguir informes óptimos, Urchin necesita una variación del formato extendido/combinado NCSA. Para configurar Apache para que utilice el formato adecuado, proceda como se indica a continuación: <p class="line874">1. Realice una copia de seguridad de su archivo httpd.conf. A continuación, utilice un editor de textos para abrir el archivo httpd.conf original. <p class="line862">2. Localice la sección que contiene las líneas que comienzan por LogFormat. <p class="line862">3. Introduzca una nueva línea LogFormat utilizando una de las formas que se indican a continuación, en función de si utiliza UTM. La entrada LogFormat debe añadirse al archivo de configuración como una única línea sin retornos de carro ni saltos de línea. Preste especial atención para introducir correctamente todos los caracteres. <p class="line867"><strong>Para sitios web que no utilizan UTM:</strong> <p class="line867"><tt>LogFormat&nbsp;"%h&nbsp;%v&nbsp;%u&nbsp;%t&nbsp;\"%r\"&nbsp;%&gt;s&nbsp;%b&nbsp;\"%{Referer}i\"&nbsp;\"%{User-Agent}i\""&nbsp;urchin</tt> <p class="line867"><strong>Para sitios UTM-enabled:</strong> <p class="line867"><tt>LogFormat&nbsp;"%h&nbsp;%v&nbsp;%u&nbsp;%t&nbsp;\"%r\"&nbsp;%&gt;s&nbsp;%b&nbsp;\"%{Referer}i\"&nbsp;\"%{User-Agent}i\"&nbsp;\"%{Cookie}i\""&nbsp;urchin</tt> <p class="line862">4. La palabra "urchin" al final de la línea LogFormat es un alias que se utiliza en otro lugar de httpd.conf para aplicar este formato a un archivo de registro. En esta cadena puede indicar lo que desee, pero si utiliza "urchin" le será más fácil identificar que dicha entrada se creó para acoger el procesamiento de Urchin. <p class="line862">5. Examine la entrada &lt;VirtualHost&gt; para la que desea activar este nuevo formato del registro. Desactive todas las entradas TransferLog y CustomLog existentes en un grupo &lt;VirtualHost&gt;&lt;/VirtualHost&gt; introduciendo el símbolo # delante (o sea, TransferLog pasaría a ser #TransferLog). A continuación, introduzca la nueva entrada CustomLog, cambiando la cadena path_to_log por la ruta correspondiente a la ubicación del registro: <p class="line867"><tt>CustomLog&nbsp;path_to_log/access.log&nbsp;urchin</tt> <p class="line862">Si como alias elige otro identificador distinto de "urchin" para la entrada LogFormat que se comentó anteriormente, utilícelo en lugar de "urchin" en la entrada CustomLog. <p class="line874">6. Guarde los cambios del archivo httpd.conf. <p class="line862">7. <strong>IMPORTANTE</strong> Compruebe la sintaxis de su nuevo archivo httpd.conf ejecutando el comando siguiente: <p class="line867"><tt>apachectl&nbsp;configtest</tt> <p class="line874">Esto debe generar una respuesta que indica que la sintaxis es correcta. En caso contrario, vuelva a comprobar el archivo httpd.conf y repare cualquier error. Si no puede obtener la respuesta correcta, no continúe con este procedimiento. En su lugar, realice una copia de seguridad de su archivo editado y restaure el original sobrescribiendo esta versión con la copia de httpd.conf que guardó al comenzar este procedimiento. De esta forma se asegurará de que el servidor web continúa funcionando normalmente mientras localiza los errores de sus cambios. <p class="line874">8. Una vez que esté confirmada la sintaxis de su archivo httpd.conf, reinicie Apache. El método preferido es el llamamiento de la secuencia de comandos apachectl, que normalmente se instala con Apache. <p class="line867"><tt>apachectl&nbsp;restart</tt> <p class="line862">9. Compruebe el registro. Abra un navegador y acceda al sitio en cuestión varias veces. A continuación, examine las últimas líneas del archivo de registro especificadas en su entrada de CustomLog. Deberán haberse escrito varios resultados recientes en el registro. <p class="line874">En el formato de registro extendido/combinado modificado de Urchin, la línea de registro será similar a: <p class="line867"><tt class="backtick">64.40.51.27</tt> <tt class="backtick">www.urchin.com</tt> <tt class="backtick">-</tt> <tt class="backtick">[28/Aug/2002:15:11:01</tt> <tt class="backtick">-0700]</tt> <tt class="backtick">"GET</tt> <tt class="backtick">/images/urchin_header_logo.gif</tt> <tt class="backtick">HTTP/1.1"</tt> <tt class="backtick">200</tt> <tt class="backtick">3017</tt> <tt class="backtick">"http://www.urchin.com/"</tt> <tt class="backtick">"Mozilla/4.0</tt> <tt class="backtick">(compatible;</tt> <tt class="backtick">MSIE</tt> <tt class="backtick">6.0;</tt> <tt class="backtick">Windows</tt> <tt class="backtick">NT</tt> <tt class="backtick">5.0)"</tt> <p class="line874">Si ha configurado UTM en su sitio y ha activado el registro de cookies, una línea de registro será similar a: <p class="line867"><tt class="backtick">64.40.51.27</tt> <tt class="backtick">www.urchin.com</tt> <tt class="backtick">-</tt> <tt class="backtick">[28/Aug/2002:15:11:01</tt> <tt class="backtick">-0700]</tt> <tt class="backtick">"GET</tt> <tt class="backtick">/images/urchin_header_logo.gif</tt> <tt class="backtick">HTTP/1.1"</tt> <tt class="backtick">200</tt> <tt class="backtick">3017</tt> <tt class="backtick">"http://www.urchin.com/"</tt> <tt class="backtick">"Mozilla/4.0</tt> <tt class="backtick">compatible;</tt> <tt class="backtick">MSIE</tt> <tt class="backtick">6.0;</tt> <tt class="backtick">Windows</tt> <tt class="backtick">NT</tt> <tt class="backtick">5.0)"</tt> <tt class="backtick">"__utma=171060324.1378004559.1063331913.1063334677.1063521838.3;</tt> <tt class="backtick">__utmb=171060324;</tt> <tt class="backtick">__utmc=171060324"</tt> <p class="line874">10. Tenga en cuenta la información de cookies UTM adicional del final de la línea. <p class="line867"><strong>Microsoft Internet Information Server (IIS)</strong> <p class="line874">Nota: Microsoft IIS utiliza un formato de registro W3C. <p class="line874">Urchin puede ofrecer funciones de creación de informes muy básicos si sus archivos de registro IIS disponen de, al menos, los campos siguientes: <ul><li>Fecha </li><li>Hora </li><li>C-IP </li><li>CS-URI-Stem </li><li>SC-Status </li><li>SC-Bytes </li></ul><p class="line874">Estos campos son obligatorios. Sin ellos no podrá obtener informes significativos; sin embargo, este registro mínimo no ofrece información suficiente para la información de referencia y del navegador. Por lo tanto, se recomienda configurar propiedades de registro más detalladas para el servidor IIS. <p class="line874">Las propiedades de registro de IIS se configuran de forma independiente para cada dominio del servidor o de forma global. Para servidores muchos dominios, se recomienda la opción global. Siguiendo los pasos que se indican a continuación, se garantizará el registro de los campos de archivo del registro necesarios. Si elige registrar campos adicionales, Urchin los ignorará durante el procesamiento; sin embargo, el registro de campos innecesarios aumentará el tamaño de los archivos de registro, por lo que se recomienda registrar solo los campos que Urchin necesite. <p class="line862">1. Inicie la herramienta administración de servicios de IIS accediendo a Inicio-&gt;Programas-&gt;Herramientas administrativas-&gt;Administración de equipos. <p class="line874">2. Expanda el árbol Servicios y Aplicaciones, y seleccione Internet Information Services. Se abrirá una lista de sitios web (excepto en Windows 2003 Server, en donde deberá expandir también la carpeta Sitios Web para obtener una lista de los sitios). <p class="line874">3. Haga clic con el botón secundario en la entrada del sitio que desea modificar y seleccione Propiedades. <p class="line874">4. Seleccione la pestaña Sitio Web y en la sección de la parte inferior de esta pantalla compruebe que esté activada la casilla de verificación Habilitar registro. En el menú desplegable Formato de registro activo seleccione Formato de archivo de registro extendido W3C. <p class="line874">5. Haga clic en el botón Propiedades que se encuentra junto a Formato de registro activo. <p class="line874">6. Seleccione la pestaña Propiedades extendidas. <p class="line874">7. Active las casillas de los campos siguientes: <ul><li>Fecha [ date] </li><li>Hora [ time ] </li><li>Dirección IP de cliente [ c-ip ] </li><li>Nombre de usuario [ cs-username ] </li><li>Método [ cs-method ] </li><li>Recurso URI visitado [ cs-uri-stem ] </li><li>Consulta URI solicitada [ cs-uri-query ] </li><li>Estado de protocolo [ sc-status ] </li><li>Bytes enviados [ sc-bytes ] </li><li>Agente de usuario [ cs[User-Agent] ] </li><li>Sitio de referencia [ cs[Referer] ] </li><li>Cookie [ cs[Cookie] ] (Este campo solo es necesario para el seguimiento UTM) </li></ul><p class="line874">8. Debe asegurarse de que la casilla Procesar contabilidad esté desactivada, ya que no ofrece información de actividad de acceso web útil. <p class="line874">9. Seleccione Apply y Aceptar en todas las ventanas para guardar la configuración. <p class="line874">10. No es necesario reiniciar IIS. Comenzará a realizarse el registro según su nueva configuración. </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>