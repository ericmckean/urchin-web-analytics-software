<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>¿Cómo se gestiona el error '(7054-323-317) No se pueden restaurar bases de datos porque no existe copia de seguridad'?</strong> <p class="line867"><strong>Descripción del problema</strong> <p class="line874">Al ejecutar un perfil de Urchin, obtiene los siguientes mensajes: <p class="line874">(7050-323-317) Starting automatic rollback + <p class="line874">(7054-323 317) Unable to restore databases since backup does not exist. <p class="line867"><strong>Causa</strong> <p class="line874">Este error puede producirse si una ejecución anterior de este perfil de Urchin terminó de manera anómala. Esto puede ocurrir si el administrador del sistema terminó el proceso/la tarea del 'motor de procesamiento de registros' manualmente (desde la CLI de la consola, etc.), si se produjo otro problema inesperado que puso fin a un procesamiento de registros en curso, o tal vez debido a un reinicio del sistema, que impidió que el proceso se completase correctamente. <p class="line874">Normalmente, Urchin puede recuperarse correctamente de un cierre anómalo mediante la recuperación del último estado correcto conocido del perfil. Sin embargo, si el procesamiento de perfiles finalizó en la primera ejecución de un perfil (o en la primera ejecución de un mes), no existirá ningún archivo de seguridad que recuperar. En este caso, Urchin emite el error "No se pueden restaurar bases de datos". <p class="line874">En un nivel más técnico, el motor de procesamiento de registros de Urchin crea un archivo lock.udb en el directorio de informes para el perfil que se esté procesando en esos momentos. Este archivo se mantiene bloqueado durante el procesamiento para garantizar que solo se ejecute una sesión del motor de procesamiento de registros para el perfil en un momento dado. En el instante del inicio, el motor de procesamiento de registros comprueba si existe el archivo lock.udb. Si es así, el motor de procesamiento de registros comprueba los bloqueos actuales. En caso contrario, significa que la ejecución anterior del perfil falló, por lo que el motor intenta recuperar la última versión correcta conocida de las bases de datos del perfil antes de continuar. Como se ha señalado anteriormente, si el archivo de recuperación no existe, se emiten los mensajes de error de recuperación y termina el procesamiento de registros. <p class="line867"><strong>Solución</strong> <p class="line874">Dado que la ejecución anterior de Urchin finalizó de forma anómala, las bases de datos de Urchin del mes que se están procesando se encuentran en un estado desconocido y los datos que se incluyen en ellas no se han comprobado correctamente. Por lo tanto, es necesario eliminar los datos correspondientes al mes completo que se está procesando. En la mayoría de los casos, los únicos datos de Urchin del mes son los que se crearon durante la sesión de procesamiento fallida, por lo que no existen datos correctos. <p class="line874">Utilice el procedimiento que se detalla a continuación para restablecer los datos del perfil de Urchin y ejecutar el perfil: <p class="line867"><span class="u">Windows Systems</span> <ol type="1"><li><p class="line862">Inicie un DOS Shell (Inicio -&gt; Ejecutar -&gt; "cmd"). </li><li>Cambie el directorio a la carpeta donde se guardan los datos del perfil de Urchin, por lo general <ul><li style="list-style-type:none">C:\Program Files\Urchin\data\reports\profilename. </li></ul></li><li>Consulte el contenido del archivo lock.udb con el comando "TYPE lock.udb". Debe haber una o varias líneas formadas por entradas de fechas YYYYMM, por ejemplo, 200408. </li><li>Para cada línea YYYYMM del archivo lock.udb, realice los siguientes pasos: <ul><li>Elimine las correspondientes bases de datos mensuales de Urchin con el comando "DEL YYYYMM-*data*". </li><li>Compruebe si existe un archivo de seguridad para el mes correspondiente. Para ello, utilice el comando "DIR YYYYMM*backup*.zip". El nombre de los archivos de seguridad es YYYYMM-seguridad-YYYYMMDDHHMMSS.zip, por ejemplo, 200805-seguridad-20080331103340.zip. </li><li>Si existe uno o varios archivos de seguridad para ese mes, restablezca los datos del archivo de seguridad más reciente mediante el comando "..\..\..\util\unzip -o -u backupfile.zip", por ejemplo, "..\..\..\util\unzip -o -u 200805-backup-20080331103340.zip". </li></ul></li><li>Elimine el archivo lock.udb con el comando "DEL lock.udb". </li><li>Ahora puede volver a ejecutar el perfil con el botón "Ejecutar" ahora. </li></ol><p class="line862">sistemas de tipo <span class="u">UNIX</span> <ol type="1"><li>Inicie un shell de comandos como usuario "raíz" o el usuario que ejecute Urchin. </li><li>Cambie el directorio a la ubicación donde se guardan los datos del perfil de Urchin, por ejemplo, <ul><li style="list-style-type:none">"cd /usr/local/urchin/data/reports/profilename". </li></ul></li><li>Consulte el contenido del archivo lock.udb con el comando "cat lock.udb". Debe haber una o varias líneas formadas por entradas de fechas YYYYMM, por ejemplo, 200803. </li><li>Para cada línea YYYYMM de lock.udb, realice los siguientes pasos: <ul><li>Elimine las correspondientes bases de datos mensuales de Urchin con el comando "rm YYYYMM-*data*". </li><li>Compruebe si existe un archivo de seguridad para el mes correspondiente. Para ello, utilice el comando <ul><li style="list-style-type:none">"ls YYYYMM*backup*.zip". El nombre de los archivos de seguridad es YYYYMM-backup-YYYYMMDDHHMMSS.zip, por ejemplo, 200803-backup-20080331103340.zip. </li></ul></li><li>Si existe uno o varios archivos de seguridad para ese mes, restablezca los datos del archivo de seguridad más reciente mediante el comando "../../../util/unzip -o -u backupfile.zip", por ejemplo, "../../../util/unzip -o -u 200803-backup-20080331103340.zip". </li></ul></li><li>Elimine el archivo lock.udb con el comando "rm lock.udb". </li><li>Ahora puede volver a ejecutar el perfil con el botón Ejecutar ahora. </li></ol></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>