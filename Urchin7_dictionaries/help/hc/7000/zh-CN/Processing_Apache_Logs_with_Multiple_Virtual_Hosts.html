<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>处理含多个虚拟主机的 Apache 日志</strong> <p class="line867"><strong>简介</strong> <p class="line874">组织机构的 Apache 网络服务器可能含有多个虚拟主机，其中所有托管网站的日志都将记录到一个日志文件中。由 Urchin 分别处理每个虚拟主机的独立日志效率更高，不过也可以配置每台虚拟主机的配置文件，使其读取同一综合日志。 <p class="line867"><strong>步骤</strong> <p class="line867"><strong>第 1 步：</strong> 确保将您的 Apache 网络服务器配置为以正确的 Urchin 格式创建日志。尤其是，您应确保按照以下顺序记录以下字段。 <ol type="1"><li>远程主机 [%h] </li><li>所请求的主机 [%v] </li><li>用户名 [%u] </li><li>日期和时间 (NCSA) [%t] </li><li>请求 (NCSA) [%r] </li><li><p class="line862">状态 [%&gt;s] </li><li>字节 [%b] </li><li>引荐网址 [%{Referer}i] </li><li>用户代理 [%{User-Agent}i] </li><li>Cookie（如果您有记录 Cookie，例如 UTM 的 Cookie）[%{Cookie}i] </li></ol><p class="line867"><strong>第 2 步：</strong> 在 Urchin 管理界面中，导航至"配置"-&gt;"Urchin 配置文件"-&gt;"日志管理器"，并添加指向您单个日志文件的日志源。选择"自动"作为日志格式。 <p class="line867"><strong>第 3 步：</strong> 在"配置"-&gt;"Urchin 配置文件"下，为各台虚拟主机创建一个新的配置文件。在"添加配置文件"向导中，为各配置文件添加日志源时选择"添加现有的日志源"，并选择前面所配置的日志源。 <p class="line867"><strong>第 4 步：</strong> 现在，进入"过滤器管理"，点击"添加"按钮以添加新的过滤器。在"过滤器向导：设置"屏幕中，选择"只包括模式"作为过滤器类型，选择"cs_host(RAW)"作为过滤区域，并在"过滤器模式"字段中输入虚拟主机名称。然后，将此过滤器分配给相应的配置文件。 <p class="line867"><strong>第 5 步：</strong> 针对各台虚拟主机重复第 3-4 步。 <p class="line867"><strong>注意事项</strong> <p class="line874">虽然上述方法有利于为多个虚拟主机提供报告，但却需要 Urchin 针对每台虚拟主机都重新处理整个日志文件。对于较大的日志文件，这可能导致产生巨大的系统开销，因而影响到 Urchin 的性能。我们强烈建议您为每台虚拟主机单独创建一个日志文件。 <p class="line874">上述方法专门针对 Apache，不过，对于其他以同样的 NCSA 类型的字段记录日志的网络服务器日志格式，过程与此类似。 <p class="line874">目前，Urchin 无法自动检测新的虚拟主机并自动为其配置新的配置文件。您必须明确设置所有配置文件。 </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>