<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>减少 Urchin 配置文件每月数据库的磁盘存储空间</strong> <p class="line867"><strong>概述</strong> <p class="line874">Urchin 的报告数据存储在 Urchin 内配置的各个配置文件所独有的每月数据库中。这些数据库一般位于 Urchin 发行套装的 data/reports 目录下。默认情况下，Urchin 会保留每月的这些配置文件数据库，数量不限。对于大部分中小型网站来说，Urchin 对存储空间的要求适中。因为 Urchin 报告功能在完成对原始网络服务器日志的处理后就不再需要访问它们，因此无需保留网络服务器日志。经过处理的 Urchin 每月数据库会减少为已处理并填充到 Urchin 数据库的原始网络服务器日志大小的 5% 至 10%；在大多数情况中，就算您无限期地保留了所有的 Urchin 数据库，它们占用的磁盘空间也非常小。 <p class="line874">但是，对于每天生成成百上千 MB 的网络服务器日志的大型网站，或配置了大量配置文件的托管服务提供商而言，降低 Urchin 不断增加的数据存储要求可能就是理想的选择。可通过下列方法之一实现这一点： <ol type="1"><li>将配置文件设置为，在处理日志后自动删除原始跟踪数据 </li><li>设置配置文件以存档历史记录数据 </li><li>限制保留历史记录报告数据的月份数。 </li></ol><p class="line874">本文最后会提供有关各个方法的说明。 <p class="line867"><strong>Urchin 数据库存储技术概述</strong> <p class="line874">对于每个 Urchin 配置文件，Urchin 会在名为 YYYYMM 的目录下，维护每月存储的一组数据库文件。这些目录分别包含约 50 个为报告引擎提供数据的文件。这些目录和数据库文件以其存储数据的月份来命名。完整的数据库列表是： <p class="line862">YYYYMM-uhed --&gt; 数据库标头 <p class="line862">YYYYMM-usti --&gt; 字符串索引 <p class="line862">YYYYMM-ustd --&gt; 字符串数据 <p class="line862">YYYYMM-udai --&gt; 汇总表索引 <p class="line862">YYYYMM-udXX --&gt; 汇总数据表（XX 由数据地图的表编号替换）。 <p class="line862">YYYYMM-uvii --&gt; 访问者索引 <p class="line862">YYYYMM-uvid --&gt; 访问者数据 <p class="line862">YYYYMM-used --&gt; 会话数据 <p class="line862">YYYYMM-upad --&gt; 路径数据 <p class="line862">YYYYMM-utrd --&gt; 交易数据 (Ecommerce) <p class="line862">YYYYMM-uitd --&gt; 项目数据 (Ecommerce) <p class="line862">YYYYMM-ulti --&gt; 日志跟踪索引 <p class="line862">YYYYMM-ultd --&gt; 日志跟踪数据 <p class="line862">YYYYMM-utod --&gt; 总计数据 <p class="line862">YYYYMM-uhid --&gt; 柱状图数据 <p class="line862">YYYYMM-umad --&gt; 访问者矩阵数据 <p class="line874">每一组数据库对于所包含数据的月份来说都是完整的。因为每月的数据库集之间并无相关性，因此可对每个数据库集独立进行存档和修剪操作，其他月份的数据不会受到影响。 <p class="line874">正常操作下会保留每个月的整套月份数据库文件。不过，Urchin 日志处理引擎只会使用这些数据库文件的 4 个文件。这些数据库文件是： <p class="line874">YYYYMM-usti <p class="line874">YYYYMM-udai <p class="line874">YYYYMM-ulti <p class="line874">YYYYMM-ultd <p class="line874">Urchin 日志处理引擎会使用下列数据库文件处理跨群体和访问者深入查看报告。删除这些内容仅会影响到这些报告功能。 <p class="line874">YYYYMM-uvii <p class="line874">YYYYMM-uvid <p class="line874">YYYYMM-used <p class="line874">YYYYMM-upad <p class="line874">YYYYMM-utrd <p class="line874">YYYYMM-uitd <p class="line874">这些数据库包含有关访问者、会话、路径、交易和产品的信息。这些文件会使用当月所需总存储空间的某个百分比，大约 10% 到 50% 左右。因此，如果将"配置文件配置"的"存储/数据库"屏幕的"保留原始跟踪数据"选项设为关闭的话，即可赢得较大的磁盘空间。 <p class="line874">建议只有访问量极高、保留原始跟踪数据会造成磁盘或 CPU 资源消耗问题的网站，才停用"保留原始跟踪数据"选项。 <p class="line874">另一个可用的磁盘空间节省方法，是将旧的 Urchin 每月数据库压缩为 ZIP 存档。所产生存档的大小一般只有未压缩前数据库集的 20% 到 30% 左右。虽然 Urchin 报告引擎无法直接读取 ZIP 存档，但它可随时从 ZIP 存档中提取所需数据库。除了在解压缩数据库时需要多花一点时间外，这个方法对于查看 Urchin 报告的人不会有任何影响。报告引擎不会删除已解压缩的数据库，这可提高用户查看 Urchin 报告时对数据的访问速度。不过，原始的 ZIP 存档会保留在原处，因此定期清除操作可直接删除解压缩后的数据库，以重新获取磁盘空间。 <p class="line874">减少 Urchin 对存储空间要求的最后一条途径，是为 Urchin 所提供的历史记录报告制订保留时间政策。例如，在以 Urchin 作为托管软件包报告服务工具的环境中，提供一年期的 Urchin 历史记录是很常见的事。由于 Urchin 数据库是按月加以组织，所以可以很方便地以自动脚本机制自动删除保留时间已超过某个期限的旧的每月数据库。执行历史报告时间长度政策后，Urchin 对数据存储空间的要求一般会稳定下来，或只有在达到历史记录保留时限时略有增加。 <p class="line867"><strong>减少数据存储空间的方法 - 操作方法</strong> <p class="line867"><strong>方法 1：在处理日志后，删除原始跟踪数据</strong> <p class="line874">可对配置文件加以配置，以便在处理完成后删除原始访问者和会话信息。这可改善大型网站的性能，降低所存储的数据量。请注意：选择此配置后，跨日期的会话会显示为两个会话（一天一个会话），而不是一个会话。对大部分网站来说，结果中的差异可以忽略不计。 <p class="line874">对配置文件加以配置，以便在处理完成后删除原始访问者和会话信息： <ol type="1"><li><p class="line862">在管理界面中，点击"配置"，然后再点击"Urchin 配置文件"--&gt;"配置文件"。 </li><li>修改所需配置文件。 </li><li>在"存储/数据库"标签中，将"保留原始跟踪数据"字段设为"关闭"。 </li><li>点击"更新"。 </li></ol><p class="line867"><strong>方法 2：自动存档历史记录数据</strong> <p class="line874">可对配置文件加以配置，将每月历史记录数据压缩到存档文件中。报告可以查看存档的数据，但不会再为已存档的月份处理额外的点击。 <p class="line874">对配置文件加以配置以存档历史记录数据： <ol type="1"><li><p class="line862">在管理界面中，点击"配置"，然后再点击"Urchin 配置文件"--&gt;"配置文件"。 </li><li>修改所需配置文件。 </li><li>在"存储/数据库"标签中，将"存档数据库"字段设为"打开"。 </li><li>为"在此后存档数据库"字段指定月份数字。 </li><li>点击"更新"。 </li></ol><p class="line867"><strong>方法 3：对保留历史报告所用的数据库加以限制</strong> <p class="line874">对于每个 Urchin 配置文件，只需删除"data/reports/profile-name"目录下以 YYYYMM 前缀开头且已超过历史报告保留时间限制的数据库即可。例如，如果您希望保留一年期的报告历史记录，而现在是 2004 年 2 月，则应删除任何名为 200301-*data.un* 的数据库，以删除此 Urchin 配置文件的 2003 年 1 月的报告数据。可对 2003 年 1 月之前的所有数据库执行相同操作。 </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>