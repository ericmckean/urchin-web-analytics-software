<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Urchin プロファイルの月別データベースのディスク容量を減らす</strong> <p class="line867"><strong>概要</strong> <p class="line874">Urchin のレポート データは、Urchin で設定された各プロファイルのデータベースに月別で保存されます。 通常これらのデータベースは Urchin の data/reports ディレクトリにあります。 デフォルトでは、Urchin が保存する月別プロファイル データベースの数に制限はありません。 ほとんどの中小規模のサイトでは、保存容量の要件はほとんど問題ありません。 Urchin のレポートでは、ウェブサーバーのログを処理した後は元のログにアクセスする必要はないため、ウェブサーバーのログを保存する必要はありません。 処理後の Urchin の月別データベースのサイズは、Urchin データベースに取り込むために処理された元のウェブサーバー ログの約 5～10 % にすぎず、すべての Urchin データベースを無期限に保管した場合でも、ほとんどの場合はディスク容量のごく一部を占めるだけです。 <p class="line874">一方、何百メガバイトや何千メガバイトものウェブサーバー ログを日々生成する大規模なサイトや、非常に多くのプロファイルを設定しているホスティング プロバイダの場合は、必要に応じて Urchin の処理中のデータ保存容量の要件を抑えます。 これには次の方法があります。 <ol type="1"><li>ログを処理した後に元のトラッキング データを自動的に削除するようプロファイルを設定する。 </li><li>過去のデータをアーカイブするようプロファイルを設定する。 </li><li>保管する過去のレポート データの月数を制限する。  </li></ol><p class="line874">手順についてはこの記事の最後をご覧ください。 <p class="line867"><strong>Urchin データベース保存容量の技術的概要</strong> <p class="line874">Urchin の各プロファイルについて、「YYYYMM」という名前のディレクトリにデータベース ファイルが毎月保存されます。  各ディレクトリには最大 50 個のファイルが含まれ、レポート エンジンにデータを提供しています。 ディレクトリとデータベース ファイルには、データが保存された月の名前が付けられます。 データベースの全リストは次のとおりです。 <p class="line862">YYYYMM-uhed --&gt; データベースのヘッダー <p class="line862">YYYYMM-usti --&gt; 文字列のインデックス <p class="line862">YYYYMM-ustd --&gt; 文字列のデータ <p class="line862">YYYYMM-udai --&gt; 総合表のインデックス <p class="line862">YYYYMM-udXX --&gt; 総合データの表 (XX はデータマップの表番号に置き換えられます) <p class="line862">YYYYMM-uvii --&gt; ユーザーのインデックス <p class="line862">YYYYMM-uvid --&gt; ユーザーのデータ <p class="line862">YYYYMM-used --&gt; セッションのデータ <p class="line862">YYYYMM-upad --&gt; パスのデータ <p class="line862">YYYYMM-utrd --&gt; トランザクションのデータ (e コマース) <p class="line862">YYYYMM-uitd --&gt; アイテムのデータ (e コマース) <p class="line862">YYYYMM-ulti --&gt; ログ トラッキングのインデックス <p class="line862">YYYYMM-ultd --&gt; ログ トラッキングのデータ <p class="line862">YYYYMM-utod --&gt; 合計のデータ <p class="line862">YYYYMM-uhid --&gt; 棒グラフのデータ <p class="line862">YYYYMM-umad --&gt; ユーザー マトリックスのデータ <p class="line874">各データベース セットは、含まれるデータの月ごとに完結しています。 月別データベース セットはそれぞれ独立しているため、他の月に影響を与えることなく、各データベース セットを単独でアーカイブしたり操作できます。 <p class="line874">通常、各月の月別データベース ファイル セットはまとめて保管されます。 また、これらのデータベース ファイルのうち次の 4 つは Urchin ログ処理エンジンでのみ 使用されます。 <p class="line874">YYYYMM-usti  <p class="line874">YYYYMM-udai  <p class="line874">YYYYMM-ulti <p class="line874">YYYYMM-ultd <p class="line874">次のデータベース ファイルは、Urchin ログ処理エンジンによって、レポートのセグメント間のクロス集計とユーザー詳細に使用されます。  コンテンツを削除すると、これらのレポート機能にのみ影響します。 <p class="line874">YYYYMM-uvii  <p class="line874">YYYYMM-uvid  <p class="line874">YYYYMM-used  <p class="line874">YYYYMM-upad  <p class="line874">YYYYMM-utrd  <p class="line874">YYYYMM-uitd  <p class="line874">これらのデータベースには、ユーザー、セッション、パス、トランザクション、商品に関する情報が含まれています。  これらのファイルは、各月に必要な総保存容量の約 10～50 % という高い割合を占めます。 このため、プロファイル設定のストレージ/データベース画面で [元のトラッキング データの保存] オプションをオフに設定すると、かなりのディスク容量を空けることができます。 <p class="line874">トラフィックが非常に多いサイトで、元のトラッキング データを保存しているためディスクまたは CPU のリソース消費の問題が発生している場合のみ、[元のトラッキング データの保存] オプションを無効にすることをおすすめします。 <p class="line874">ディスク容量を減らす他の方法としては、Urchin の過去の月別データベースを圧縮して ZIP アーカイブにします。 通常、データベース セットをアーカイブするとサイズが 20～30 % になります。 Urchin レポート エンジンは直接 ZIP アーカイブを読み込むことはできませんが、必要な場合はその場で ZIP アーカイブからデータベースを抽出できます。 この処理は、データベースの解凍中に処理が若干遅くなる以外、Urchin レポートを参照しているユーザーにはわかりません。 レポート エンジンでは解凍されたデータベースを削除しません。これにより、Urchin レポートを参照するユーザーに迅速にデータを提供できます。 ただし、元の ZIP アーカイブは元の場所に残されているため、解凍されたデータベースを定期的に削除して、ディスク容量を確保します。 <p class="line874">Urchin の保存容量の要件を抑える最後の方法は、Urchin が提供する過去のレポートの保存期間についてポリシーを定めることです。 たとえばホスティング パッケージでレポート サービスとして Urchin が提供される環境では、Urchin の過去 1 年分のデータを提供することが一般的です。 Urchin データベースは月単位で作成されるため、自動スクリプト メカニズムを使用して、特定の基準を過ぎた古い月のデータベースを簡単に削除できます。 過去のレポートの保存期間のポリシーを定めると、Urchin のデータ保存容量の要件は保存期間の終了前に若干増加する程度で安定します。 <p class="line867"><strong>データ保存容量を減らす方法 - 手順</strong> <p class="line867"><strong>方法 1:  ログ処理後に元のトラッキング データを削除する</strong> <p class="line874">ログ処理後に元のユーザー情報とセッション情報を削除するようプロファイルを設定できます。 大規模なサイトの場合は、この処理によりパフォーマンスが向上し、保存されているデータ量を減らすことができます。 注: この設定が選択されている場合、日付をまたぐセッションは 1 つのセッションではなく、2 つのセッション (各日付に 1 つ) として表示されます。 この違いはほとんどのサイトでごくわずかなものです。 <p class="line874">ログ処理後に元のユーザー情報とセッション情報を削除するようプロファイルを設定する方法は次のとおりです。 <ol type="1"><li>管理インターフェースで [構成]、[Urchin プロファイル]、[プロファイル] の順にクリックします。 </li><li>該当のプロファイルを編集します。 </li><li>[ストレージ/データベース] タブで [元のトラッキング データの保存] オプションをオフにします。 </li><li>[更新] をクリックします。  </li></ol><p class="line867"><strong>方法 2:  過去のデータの自動アーカイブ</strong> <p class="line874">過去の月別データを圧縮してアーカイブするようプロファイルを設定できます。 レポートではアーカイブされたデータを参照できますが、データがアーカイブされている月のヒットは処理されなくなります。 <p class="line874">過去のデータをアーカイブするようプロファイルを設定する方法は次のとおりです。 <ol type="1"><li>管理インターフェースで [構成]、[Urchin プロファイル]、[プロファイル] の順にクリックします。 </li><li>該当のプロファイルを編集します。 </li><li>[ストレージ/データベース] タブで [データベースのアーカイブ] オプションをオンにします。 </li><li>[下記の月数以前のデータベースをアーカイブ] フィールドで月数を指定します。 </li><li>[更新] をクリックします。  </li></ol><p class="line867"><strong>方法 3:  過去のレポートのデータベース保存期間を制限する</strong> <p class="line874">Urchin の各プロファイルでは、data/reports/profile-name (プロファイル名) ディレクトリで、過去のレポートの保存期間を過ぎた YYYYMM プレフィックスで始まるデータベースを削除します。 たとえば現在 2004年2月で、過去 1 年分のレポートを保存するとします。この場合、該当の Urchin プロファイルの 200301-*data.un* という名前のデータベースをすべて削除して、2003年1月からのレポート データを削除します。 この処理を 2003年1月以前のすべてのデータベースについて繰り返します。 </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>