<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Urchin 6.x とすべてのレポート データを別のサーバーに移動する</strong> <p class="line874">Urchin 6.x を別のサーバーに移動する方法は次のとおりです。 <ol type="1"><li>Urchin データベースを用意します。 </li><li>新しいサーバーに Urchin 6.x をインストールします。 </li><li>プロファイルの Urchin レポート データベースを移動します。 </li><li>カスタムのファイルとテンプレートを移動します。 </li><li>Urchin のカスタム設定を適用します。 </li><li>新しいファイルの権限を確認します。 </li><li>Urchin ライセンスを再登録します。 </li></ol><p class="line874">注:  この手順はプラットフォーム間の移動にも使用できます。 Urchin がサポートするオペレーティング システムであれば、Urchin レポート データベースのファイルを移動することができます。 異なる種類のプラットフォームにデータとファイルを移動する場合は、コマンド ラインのシンタックスを考慮する必要があります (Unix の場合は「./」を追加するなど)。 また、「Standard\Windows\folders\」と「/standard/unix/directories/」など、ディレクトリ構文の違いも考慮する必要があります。 <p class="line867"><strong>1. Urchin データベースを用意します。</strong> <p class="line874">同じデーターベース サーバーに新しく Urchin をインストールする場合、この手順は省略できます。 新しいサーバーを使用する場合は、インストール前に Urchin データベースを用意しておく必要があります。 <p class="line867"><strong>a. </strong>      空の Urchin データベースを作成し、Urchin ユーザーに適切な権限を設定します。 <p class="line874">MySQL バックエンド データベースを作成する SQL コマンドのサンプルは次のとおりです。 <p class="line867"><pre>   mysql&gt; create database urchin character set utf8;
   mysql&gt; GRANT ALL ON urchin.* to 'urchin'@'localhost' IDENTIFIED BY 'urchinpassword';
</pre><p class="line874">PostreSQL バックエンド データベースを作成する PSQL コマンドのサンプルは次のとおりです。 <p class="line867"><pre>   postgres=# CREATE DATABASE urchin WITH ENCODING 'UTF8';
   postgres=# CREATE USER urchin WITH PASSWORD 'urchin password';
   postgres=# GRANT ALL ON DATABASE urchin TO urchin;
   postgres=# \connect urchin;
   postgres=# CREATE LANGUAGE 'PLPGSQL';
</pre><p class="line867"><strong>b. </strong>      旧データベースの SQL ダンプを作成して新しいデータベースにインポートし、旧サーバーの Urchin データベース データをコピーします。 これにより、プロファイル、ログ ソース、ユーザー、アカウント、グループ、スケジューラなど、必要な Urchin 構成のほとんどが自動的にコピーされます。 <p class="line874">MySQL バックエンド データベースの SQL コマンドのサンプルは次のとおりです。 <ul><li style="list-style-type:none">ソース データベース: </li></ul><p class="line867"><pre>   mysqldump –h {oldDBhostname} –u {username} –p {urchinDBname} &gt; urchin.sql
</pre><ul><li style="list-style-type:none">対象データベース: </li></ul><p class="line867"><pre>   mysql –h {newDBhostname} –u {username} –p {urchinDBname} &lt; urchin.sql
</pre><p class="line874">PostreSQL バックエンド データベースの PSQL コマンドのサンプルは次のとおりです。 <ul><li style="list-style-type:none">ソース データベース: </li></ul><p class="line867"><pre>   pg_dump -h {oldDBhostname} -p {oldDBport} -U {username} {urchinDBname} &gt; urchin.sql
</pre><ul><li style="list-style-type:none">対象データベース: </li></ul><p class="line867"><pre>   psql –h {newDBhostname} –p {newDBport} -U {username} {urchinDBname} &lt; urchin.sql
</pre><p class="line867"><strong>2. 新しいサーバーに Urchin 6 をインストールします。</strong> <p class="line874">事前に用意したデータベースを使用して、新しいサーバーに Urchin 6 をインストールします。 <p class="line874">(Windows にインストールする場合は [Urchin データベース テーブルが存在する場合は削除して再作成] オプションをオフにしてください。Unix にインストールする場合は [インストール中に設定データベースを初期化しますか？] に対して [いいえ] をクリックしてください。) <p class="line874">Urchin をインストールする手順は次のとおりです (データベースの設定手順を省略し、「Urchin のインストール」から開始します)。 <ul><li><p class="line891"><a href="Urchin_Installation_Guide_(FreeBSD_and_Linux).html">Urchin インストール ガイド (FreeBSD、Linux)</a> </li><li><p class="line891"><a href="Urchin_Installation_Guide_(Windows).html">Urchin インストール ガイド (Windows)</a> </li></ul><p class="line874">次の手順に進む前に urchin のデーモンまたはサービスを停止します。 <p class="line867"><pre>~/urchin/bin/urchinctl -stop
</pre><p class="line867"><strong>3. プロファイルの Urchin レポート データベースを移動します。</strong> <p class="line874">デフォルトでは、すべての Urchin レポート データは Urchin のメイン ディレクトリのサブディレクトリ (~/urchin/data/) に保存されます。 このディレクトリは、Urchin をインストールした新しいサーバーに移動する前に、サブディレクトリ構造を維持するためにアーカイブする必要があります。 また、可能な限り、新しいサーバーでも同じディレクトリの位置 (~/urchin/data) に移動します。 <p class="line874">注:  Urchin のこれまでのインストールでカスタムの履歴ディレクトリとレポート ディレクトリを使用していた場合は、~/urchin/data/reports や ~/urchin/data/history の代わりに該当のカスタム ディレクトリをコピーする必要があります。 <p class="line867"><strong>4. カスタムのファイルとテンプレートを移動します。</strong> <p class="line874">カスタム ログの形式やレポート設定など Urchin に行ったカスタマイズは、Urchin の data ディレクトリではなく、 Urchin の lib ディレクトリの別の場所に保存されます。 新しいサーバーに Urchin をインストールした場合、これまで Urchin に対して行ったカスタマイズは、新しい Urchin にコピーする必要があります。 通常、これらのファイルは ~/urchin/lib/custom/ に保存されています。 <p class="line874">これには、前の Urchin サーバーにアクセスし、Urchin の lib ディレクトリに移動します。 次に、tar や ZIP などのアーカイブ ユーティリティを使用して、custom ディレクトリ全体 (すべてのサブディレクトリを含む) のアーカイブを作成します。 作成したアーカイブを新しい Urchin サーバー上にコピーし、Urchin の lib ディレクトリ内で解凍します。 <p class="line867"><strong>5. Urchin のカスタム設定を適用します。</strong> <p class="line874">これまでの Urchin 6.x で次のファイルのデフォルト設定を変更した場合は、 <p class="line867"><pre>/etc/session.conf
/etc/urchin.conf
/var/urchinwebd.conf
</pre><p class="line874">対応するファイルを編集して、新しいインストールにも同じ設定を適用します。 <p class="line867"><strong>6. 新しいファイルの権限を確認します。</strong> <p class="line874">ファイルをすべて新しいサーバーに移動したら、すべてのファイルに必要な権限が設定されていることと、所有者が同じユーザーであること (UNIX の場合のみ) を確認します。 <p class="line874">Urchin の権限を変更するには、~/urchin/util/ ディレクトリで次のコマンドを実行します。 <p class="line867"><pre>        inspector -r
</pre><p class="line874">ファイルの所有権を確認するには (UNIX のみ)、~/urchin/ ディレクトリで次のコマンドを実行します。 <p class="line867"><pre>        chown -R urchin_user:urchin_group ./
</pre><p class="line867"><strong>7. Urchin ライセンスを再登録します。</strong> <p class="line874">urchin のデーモンまたはサービスを開始します。 <p class="line867"><pre>~/urchin/bin/urchinctl start
</pre><p class="line874">Urchin のインストールが完了したら、Urchin ウェブ インターフェースを起動します。 <p class="line874">[ライセンス Urchin] 画面に [ライセンスの再登録] リンクが表示されます。 <p class="line874">事前に用意した既存のデータベースを使用して Urchin をインストールしてシステム キーが変更されているため、ライセンスを再登録する必要があります。 <p class="line874">注:  再登録する前に、Urchin 販売代理店に連絡し、ライセンスをリセットするよう依頼してください。 </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>