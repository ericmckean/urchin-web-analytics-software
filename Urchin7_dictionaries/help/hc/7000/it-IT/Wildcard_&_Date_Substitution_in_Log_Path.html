<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Sostituzione carattere jolly e data nel percorso log</strong> <p class="line867"><strong>Panoramica</strong> <p class="line874">Urchin consente di specificare variabili per la corrispondenza della data e del carattere jolly nel percorso di un file di log. Quando viene eseguita un'attività di Urchin e viene letto il percorso log, queste variabili vengono convertite e confrontate con le directory e i nomi di file nel sistema. <p class="line874">Le funzionalità di corrispondenza della data di Urchin 6 sono più estese di quelle fornite dalle versioni precedenti di Urchin, in particolare: <ul><li>La sostituzione della data può avvenire in qualsiasi punto del nome del percorso del file di log; le versioni precedenti di Urchin consentivano sostituzioni solo nella specifica del nome di file reale. </li><li>È stato implementato un algoritmo più potente e flessibile per la corrispondenza del pattern della data, sebbene la corrispondenza del pattern di tipo AAAAMMGG sia ancora supportata per compatibilità inversa con le versioni precedenti. </li></ul><p class="line874">Le variabili e i formati per la corrispondenza dell'ora utilizzati più frequentemente sono illustrati di seguito. L'elenco completo di tutte le variabili di formattazione della data e dell'ora supportate è riportato alla fine di questo articolo. <p class="line874">* un asterisco corrisponde a nessun carattere o a più caratteri consecutivi GG viene sostituito dal giorno numerico del mese a 2 cifre, ad esempio 01-31 %g è equivalente a GG MM viene sostituito dal mese numerico a 2 cifre, ad esempio 01-12 %m è equivalente a MM AA viene sostituito dall'anno numerico a 2 cifre, ad esempio 01-99 AAAA viene sostituito dall'anno numerico a 4 cifre, ad esempio 0001-2003 %A è equivalente a AAAA <p class="line874">Tieni presente che in questo contesto l'asterisco si comporta come una corrispondenza a un nome di file come in un'interfaccia di riga di comando di UNIX o DOS, non come una corrispondenza di un'espressione regolare dove questo carattere corrisponderebbe a nessuna istanza o a più istanze del carattere precedente. Queste variabili possono essere combinate nel modo desiderato dall'utente. <p class="line874">L'elenco seguente mostra alcuni esempi di come le istanze di queste variabili vengono convertite il 13 agosto 2003. Tieni presente che gli indicatori del giorno GG e %g vengono convertiti nel giorno precedente al 13. <ul><li>AAAAMMGG viene convertito in 20030812 </li><li>%A-%m-%g viene convertito in 2003-08-12 </li><li>%A/%m/%g viene convertito in 2003/08/12 (ciò ha delle implicazioni in un percorso) </li><li>*AAAAMMGG corrisponde a qualsiasi nome di file che termina con la stringa 20030812  </li></ul><p class="line874">Gli indicatori del giorno GG e %g vengono convertiti nel giorno precedente per impostazione predefinita a causa del modo in cui vengono generalmente gestiti i log dei server web e l'elaborazione Urchin. In genere i log vengono ruotati giornalmente per evitare che crescano troppo e per fare in modo che ciascun log contenga principalmente i dati relativi a un singolo giorno. Questa rotazione avviene nella maggior parte dei casi immediatamente prima della mezzanotte. L'elaborazione Urchin in genere si svolge subito dopo, quando l'orologio si è spostato dopo la mezzanotte entrando nel giorno successivo del mese. Se aggiungessi le coordinate temporali di tipo AAAAMMGG al nome del file di log mentre viene ruotato, tale data differirebbe di un giorno da quella dell'esecuzione di Urchin. Valutare una conversione del giorno al momento dell'esecuzione di Urchin renderebbe impossibile l'individuazione del nome di log corretto perché le coordinate temporali del log sarebbero 20030812, ma Urchin verrebbe eseguito il 20030813. <p class="line874">Nonostante si tratti del modello più comune per la gestione log, non è l'unica opzione. Urchin include un parametro di configurazione che controlla il modo in cui queste variabili vengono risolte in un determinato giorno. L'impostazione Sostituzione carattere jolly data/ora in Nome percorso log può essere utilizzata per rettificare uno scarto del fuso orario GMT che controlli la modalità di valutazione di GG e %g. Questa impostazione viene spiegata in modo più dettagliato alla fine di questo articolo. <p class="line874">Le variabili di anno, mese e giorno possono essere utilizzate nel nome del file di log oppure nel percorso della directory/cartella del file di log. L'asterisco può essere utilizzato soltanto nella parte relativa al nome di file del percorso. Anche le variabili di formato dell'ora possono essere ripetute all'interno del percorso di una sorgente log, ma l'asterisco può essere utilizzato una sola volta. Gli esempi della sezione Procedura aiuteranno a chiarire questo concetto. <p class="line867"><strong>Procedura</strong> <p class="line874">Quando crei o modifichi una sorgente log, nel percorso devi utilizzare le variabili dell'ora che utilizzi nella casella Percorso file di log della scheda Impostazioni log. Ad esempio, un tipico schema di rotazione log giornaliera di un server web Apache crea un log con coordinate temporali che indicano la data delle voci di log, ad esempio 1 minuto dopo la mezzanotte del 16 luglio 2002 il meccanismo di rotazione log archivia il log: <pre>/var/log/httpd/access.log
</pre><p class="line874">e lo salva come <pre>/var/log/httpd/access.log.20020715
</pre><p class="line874">Per far corrispondere questo pattern nella sorgente log a un profilo Urchin, basta semplicemente specificare <pre>/var/log/httpd/access.log.YYYYMMDD
</pre><p class="line874">nel percorso del file di log e Urchin cercherà automaticamente il log del giorno precedente quando verrà eseguito in quel giorno. Come altro esempio, quando il server web Microsoft IIS è configurato per la rotazione giornaliera dei log, assegna un nome al file di log includendo la data corrente, ad esempio ex021127.log. Quindi, per elaborare un log IIS giornalmente, si utilizza una specifica del file di log simile alla seguente: <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD.log
</pre><p class="line874">nel campo Percorso file di log della sorgente log relativa al profilo. <p class="line874">Per consentire a Urchin di elaborare i log che vengono ruotati più spesso di una sola volta al giorno, puoi utilizzare una combinazione della sintassi AAAAMMGG e di caratteri jolly per cercare tutti i file di log creati il giorno precedente. Per eseguire questa operazione, devi assicurarti che il file di log ruotato sia stato denominato in modo coerente, ad esempio con un'ora aggiunta al nome di file. Nella specifica del percorso del file di log si utilizza quindi un pattern simile al seguente: <pre>/var/log/httpd/access.log.YYYYMMDD*
</pre><p class="line874">o <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD*.log
</pre><p class="line874">Un uso più complesso consiste nell'archiviare i log in directory denominate in modo da riflettere l'anno, il mese e il giorno. Supponi di disporre dei seguenti percorsi di directory per archiviare i log: <pre>/logs/2003/07
/logs/2003/08
/logs/2003/09
</pre><p class="line874">e di conservare tutti i log di un dato mese nelle rispettive directory; supponi anche che ciascun log abbia il giorno del mese aggiunto al nome di file (ad esempio access.log.01, access.log.02). Per consentire a Urchin di capire quali log elaborare, puoi utilizzare uno dei seguenti formati di percorso log: <pre>/logs/YYYY/MM/access.log.DD
/logs/%Y/%M/access.log.%d
</pre><p class="line874">Al momento dell'elaborazione log, Urchin elabora tutti i log che corrispondono al pattern della data di ieri, con eventuali suffissi. Come con qualsiasi carattere jolly nella specifica del campo Percorso file di log, è importante che il monitoraggio log per il profilo sia abilitato per garantire che Urchin non rielabori i log. <p class="line867"><strong>Considerazioni</strong> <p class="line874">Per determinare la data per il pattern di sostituzione, Urchin sottrae 24 ore dall'ora corrente, in base all'ora locale. Sarà in grado di gestire correttamente i limiti di mese e anno. Tuttavia, questa impostazione può essere modificata utilizzando il campo Sostituzione carattere jolly data/ora in Nome percorso log nella scheda Impostazioni avanzate di una sorgente log. Puoi selezionare Ora locale o Ora di Greenwich (GMT) come base per le rettifiche dell'ora, quindi utilizzare la casella di modifica Ore per specificare uno scarto di ore in più o in meno. <p class="line867"><strong>Elenco di riferimento completo per i formati di data e ora</strong> <p class="line874">Di seguito è riportato l'elenco completo delle variabili del formato di data e ora, in base alle convenzioni utilizzate nella routine strftime() della libreria C standard: <ul><li>%A = rappresentazione nazionale del nome completo del giorno della settimana. </li><li>%a = rappresentazione nazionale del nome abbreviato del giorno della settimana. </li><li>%B = rappresentazione nazionale del nome completo del mese. </li><li>%b = rappresentazione nazionale del nome abbreviato del mese. </li><li>%d = giorno del mese come numero decimale (01-31). </li><li>%e = giorno del mese come numero decimale (1-31); le cifre singole vengono precedute da uno spazio. </li><li>%H = ora (formato a 24 ore) come numero decimale (00-23). </li><li>%I = ora (formato a 12 ore) come numero decimale (01-12). </li><li>%j = giorno dell'anno come numero decimale (001-366). </li><li>%k = ora (formato a 24 ore) come numero decimale (0-23); le cifre singole vengono precedute da uno spazio. </li><li>%l = ora (formato a 12 ore) come numero decimale (1-12); le cifre singole vengono precedute da uno spazio. </li><li>%M = minuto come numero decimale (00-59). </li><li>%m = mese come numero decimale (01-12). </li><li>%p = rappresentazione nazionale di "ante meridiem" o "post meridiem". </li><li>%S = secondo come numero decimale (00-60). </li><li>%s = numero di secondi da Epoch, UTC (vedi mktime(3)). </li><li>%w = giorno della settimana (domenica come primo giorno della settimana) come numero decimale (0-6). </li><li>%Y = anno con il secolo come numero decimale. </li><li>%y = anno senza il secolo come numero decimale (00-99). </li><li>%z = scarto del fuso orario da UTC; un segno più iniziale significa a est di UTC, un segno meno a ovest di UTC, seguono le ore e i minuti con due cifre ognuno e nessun delimitatore tra di essi (forma comune per le intestazioni di data RFC 822). </li><li>%% = `%'. (da utilizzare quando è necessario un segno di percentuale letterale all'interno di una voce di data/ora)  </li></ul></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>