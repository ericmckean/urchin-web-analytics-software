<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Come faccio a gestire l'errore '(7054-323-317) Impossibile ripristinare i database. Backup non esistente'?</strong> <p class="line867"><strong>Descrizione del problema</strong> <p class="line874">Quando esegui un profilo Urchin, ricevi i messaggi seguenti: <p class="line874">(7050-323-317) Starting automatic rollback + <p class="line874">(7054-323 317) Unable to restore databases since backup does not exist. <p class="line867"><strong>Causa</strong> <p class="line874">L'errore può verificarsi se una precedente esecuzione di questo profilo Urchin è stata terminata in modo anomalo. Ciò potrebbe accadere se il processo o l'attività del 'motore di elaborazione log' sono stati terminati manualmente dall'amministratore di sistema (dalla riga di comando della console o altro), oppure se si è verificato un altro errore imprevisto che ha terminato un'elaborazione log in corso o ancora a causa di un riavvio del sistema, per cui il processo non è stato completato correttamente. <p class="line874">Di norma, Urchin è in grado di riprendere senza problemi la regolare attività dopo un blocco anomalo eseguendo un rollback all'ultimo stato normale noto del profilo. Se tuttavia l'elaborazione del profilo è stata terminata alla prima esecuzione del profilo o del mese, non sarà presente un file di backup che consenta il rollback. A questo punto, Urchin visualizza il messaggio di errore "Impossibile ripristinare i database". <p class="line874">Su un piano più tecnico, il motore di elaborazione log di Urchin crea nella directory dei rapporti un file lock.udb per il profilo che sta elaborando. Il motore tiene bloccato questo file durante l'elaborazione per assicurare che possa essere attiva una sola istanza del motore di elaborazione log in un dato momento. All'avvio il motore di elaborazione log verifica l'esistenza del file lock.udb. Se il file è presente, il motore controlla se vi sono dei blocchi e, se non ne viene trovato nessuno, la precedente esecuzione del profilo non è riuscita, quindi il motore di elaborazione log tenta di eseguire il rollback dei database del profilo all'ultimo stato normale noto, prima di procedere. Come indicato in precedenza, se l'archivio di rollback non esiste, vengono stampati i messaggi di errore di rollback e l'elaborazione log viene terminata. <p class="line867"><strong>Soluzione</strong> <p class="line874">Poiché la precedente esecuzione di Urchin è stata terminata in modo anomalo, i database Urchin relativi al mese in corso di elaborazione si trovano in uno stato sconosciuto e i dati in essi contenuti non sono stati sottoposti correttamente a checkpoint. Sarà pertanto necessario eliminare i dati di tutto il mese in corso di elaborazione. Nella maggior parte dei casi, i soli dati Urchin per il mese saranno i dati creati durante l'esecuzione dell'elaborazione non riuscita, quindi non esistono comunque dati validi. <p class="line874">Utilizza la procedura seguente per reimpostare i dati del profilo Urchin e continuare l'esecuzione del profilo: <p class="line867"><span class="u">Windows Systems</span> <ol type="1"><li><p class="line862">Avvia un DOS Shell (Start -&gt; Esegui -&gt; "cmd") </li><li>Modifica la directory nella cartella in cui sono archiviati i dati del profilo Urchin, di solito <ul><li style="list-style-type:none">C:\Program Files\Urchin\data\reports\profilename </li></ul></li><li>Visualizza il contenuto del file lock.udb con il comando "TYPE lock.udb". Devono essere presenti una o più righe costituite da voci relative a date nel formato YYYYMM, ad esempio 200408. </li><li>Per ogni riga YYYYMM del file lock.udb, procedi nel modo seguente: <ul><li>Elimina i database Urchin mensili con il comando "DEL YYYYMM-*data*" </li><li>Verifica se esiste un archivio di backup per il mese corrispondente utilizzando il comando "DIR YYYYMM*backup*.zip". Il nome degli archivi di backup segue la convenzione YYYYMM-backup-YYYYMMDDHHMMSS.zip, ad esempio 200805-backup-20080331103340.zip. </li><li>Se esistono uno o più file di backup per il mese in questione, ripristina i dati dall'archivio di backup con le coordinate temporali più recenti utilizzando il comando "..\..\..\util\unzip -o -u backupfile.zip", ad esempio "..\..\..\util\unzip -o -u 200805-backup-20080331103340.zip" </li></ul></li><li>Elimina il file lock.udb con il comando "DEL lock.udb" </li><li>A questo punto puoi eseguire di nuovo il profilo mediante il pulsante Esegui ora </li></ol><p class="line867"><span class="u">Sistemi </span>UNIX <ol type="1"><li>Apri un pannello comandi come utente "root" o come utente eseguito da Urchin </li><li>Modifica la directory nella posizione in cui sono archiviati i dati del profilo Urchin, ad esempio <ul><li style="list-style-type:none">"cd /usr/local/urchin/data/reports/profilename" </li></ul></li><li>Visualizza il contenuto del file lock.udb con il comando "cat lock.udb". Devono essere presenti una o più righe costituite da voci relative a date nel formato YYYYMM, ad esempio 200803. </li><li>Per ogni riga YYYYMM del file lock.udb, procedi nel modo seguente: <ul><li>Elimina i database Urchin mensili corrispondenti con il comando "rm YYYYMM-*data*" </li><li>Verifica se esiste un archivio di backup per il mese corrispondente utilizzando il comando <ul><li style="list-style-type:none">"ls YYYYMM*backup*.zip" Il nome degli archivi di backup segue la convenzione YYYYMM-backup-YYYYMMDDHHMMSS.zip, ad esempio 200803-backup-20080331103340.zip. </li></ul></li><li>Se esistono uno o più file di backup per il mese in questione, ripristina i dati dall'archivio di backup con le coordinate temporali più recenti utilizzando il comando "../../../util/unzip -o -u backupfile.zip", ad esempio "../../../util/unzip -o -u 200803-backup-20080331103340.zip" </li></ul></li><li>Elimina il file lock.udb con il comando "rm lock.udb" </li><li>A questo punto puoi eseguire di nuovo il profilo mediante il pulsante Esegui ora </li></ol></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>