<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>記錄輪替最佳做法</strong> <p class="line867"><strong>總覽</strong> <p class="line874">在大部分的作業環境中，通常是由系統服務與應用程式 (如網頁伺服器) 產生記錄檔，以便記錄與服務相關的動作和活動。多數情況下，作業系統和 / 或應用程式執行記錄檔定期維護也是標準做法，以控制記錄檔的大小。這樣做可以防止記錄檔無限成長、最終將硬碟空間全部使用殆盡。 <p class="line874">管理記錄的常見方式是採用定期排程記錄輪替工作，此工作會利用時間戳記重新命名現有記錄，然後再用長度為零的新記錄檔來重新啟動服務或應用程式。壓縮舊的記錄檔也是記錄輪替工作的標準做法，另一種做法是在一段年限或到達輪替週期門檻之後，刪除記錄檔。 <p class="line874">針對網頁伺服器記錄的特殊情況，通常會以每天為間隔基礎進行輪替，以確保記錄保持在方便管理的大小。此外，每天輪替時程通常可提供豐富的資料，以便使用如 Urchin 的分析工具進行網頁伺服器後置處理。部分網頁伺服器 (如 Microsoft 的 IIS) 內建有記錄輪替功能，啟用該功能後，依預設會每天輪替記錄。其他網頁伺服器 (如 Apache) 則沒有明確的記錄輪替控制器，但提供了便於重新啟動網頁伺服器 (而不會遺漏網頁服務) 的工具，以彌補記錄輪替作業之不足 (例如 apachectl 重新啟動)。 <p class="line867"><strong>記錄輪替做法</strong> <p class="line874">多虧了 Urchin 的「記錄追蹤」技術，記錄輪替已不需要避免重複處理記錄。這樣做讓 Urchin 在處理記錄時的靈活性大幅提高，例如處理網頁伺服器仍在寫入中的「即時」記錄能力，或處理手動或不定期輪替記錄的能力。 <p class="line867"><strong>重要注意事項：</strong> 與 Urchin 先前的部分版本不同，Urchin 6 不提供實施記錄輪替程序的掛勾機制，也不提供執行記錄輪替工作後重新啟動網頁伺服器的掛勾機制，不過可以完成特定的後置記錄處理動作，詳情如下所述。 <p class="line874">雖然 Urchin 6 操作不要求網頁伺服器記錄定期輪替或根本不要求輪替，但仍建議您採用標準記錄輪替機制，以確保操作流暢，同時能避免「記錄追蹤」公用程式進行大量不必要的處理。無論從系統和應用程式的觀點來看，管理數個較小記錄都比管理一個大型記錄的效益更高，因為檔案處理的速度會隨著檔案大小成長而大幅趨緩。較小的檔案也比較容易進行備份，若硬碟或其他系統故障時，也比較容易復原。 <p class="line874">記錄輪替機制不需過於複雜。多數情況下，只需從 UNIX 類型系統的 Cron 每天執行簡單的殼層指令碼或 Perl 指令碼即可。指令碼只要能夠輪替現有網頁伺服器記錄並為其加上時間戳記 (建議使用 %Y%m%d 或 YYYYMMDD 格式)，以及重新啟動網頁伺服器即可。您也可以新增其他邏輯以剔除舊的記錄檔，來維持硬碟的使用空間。 <p class="line867"><strong>設定 Urchin 使用記錄輪替</strong> <p class="line862">您的記錄輪替機制建立完成之後，設定 Urchin 處理輪替記錄可說是易如反掌。您可以在設定「記錄來源」時，設定「記錄檔案路徑」規格使用符合時間戳記記錄檔名模式的萬用字元 (例如 access-log.* 適用於 Apache 記錄或 ex*.log 適用於 IIS 記錄)；您也可以使用 Urchin 內建的時間戳記模式比對 (例如 access-log.%Y%m%d 適用於 Apache、ex%y%m%d.log 適用於 IIS)。Urchin 碰到此模式時，就會針對 %Y%m%d 模式取代昨天的日期，並使用取代後的檔名處理記錄 （例如 access-log.20020617）。如需關於日期比對模式的詳細資訊，請參閱記錄路徑中的萬用字元與日期取代。 <p class="line874">萬用字元規格有其優勢，能讓您在單一目錄內放置數個未處理記錄，並要求 Urchin 於下次執行時進行處理。Urchin 執行時預期的記錄檔若沒有就定位 (例如：因為遠端網頁伺服器當機或遺失網路連線)，此特性在這種情況下特別實用。劣勢之處在於 Urchin 必須開啟目錄並搜尋各記錄檔，才能判定該檔案是否已經處理。若目錄中有大量記錄檔，這樣做可能會帶來龐大的負擔。如果您認為自己的記錄輪替機制可以信賴，使用 YYYYMMDD 模式比對機制效率較佳。 <p class="line862">您或許也希望 Urchin 6 在完成檔案處理後，就刪除或封存 / 壓縮記錄。您可以在「記錄來源」的 [進階設定] 中設定不同的「記錄命運」選項。若需關於「記錄命運」設定的詳細資訊，請參閱記錄管理。 <p class="line867"><strong>重要！</strong> 尚未輪替的即時記錄中不應使用「記錄命運」選項！ <p class="line867"><strong>在 UNIX 類型系統上設定記錄輪替</strong> <p class="line874">因為作業系統的功能及網頁伺服器的組態變化多端，同時記錄輪替程序僅適用於特定網站的可能性很高，所以要在 UNIX 類型系統上建立網頁伺服器記錄輪替，並無葵花寶典可供參考。 <p class="line867"><strong>針對 Windows IIS Webserver 設定記錄輪替</strong> <p class="line874">如前所述，雖然按照預設此功能並未啟用，但 IIS 的管理功能可讓網頁伺服器記錄自動進行記錄輪替。請按照下列步驟來設定恰當的 IIS 網頁伺服器記錄輪替方式。建議您每天輪替記錄，同時設定於當地時間進行記錄輪替。根據預設，IIS 會於 GMT 午夜時分輪替記錄，而不是按當地時間輪替。 <p class="line874">在 Windows 2000 之下，您應確保 IIS 網頁伺服器進行了恰當的記錄輪替設定。這項設定可以利用 Windows 2000 的「電腦管理」功能來完成。Windows NT、Windows XP 與 Windows 2003 伺服器都採用類似程序。若要開啟「電腦管理」並建立記錄輪替，請執行下列動作： <ul><li><p class="line862">按一下 [開始] &gt; [設定] &gt; [控制台] </li><li>按兩下 [管理工具] </li><li>按兩下 [電腦管理]。 </li><li>按兩下 [網際網路資訊服務] </li><li>用滑鼠右鍵按一下 [預設網站]，然後選取 [內容] </li><li>在彈出式視窗中，選取 [網站] 標籤 </li><li>在視窗底部按一下 [內容] 標籤 </li><li>按一下「新記錄時段」標題下方的 [每天] 圓形按鈕 </li><li>按一下 [使用當地時間命名檔案] 並讓滑鼠滑過核取方塊。 </li></ul><p class="line874">這樣做便能確保 IIS 於每天午夜過後，就會立刻輪替網頁伺服器的記錄 </div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>