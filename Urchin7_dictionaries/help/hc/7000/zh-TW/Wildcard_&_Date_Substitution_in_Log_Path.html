<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>記錄路徑中的萬用字元與日期替代字元</strong> <p class="line867"><strong>總覽</strong> <p class="line874">Urchin 能讓您指定萬用字元與日期，使路徑中的變數與記錄檔相符。執行 Urchin 工作並讀取記錄路徑時，會轉換變數並比較，找出與您系統上目錄和檔案名稱相符者。 <p class="line874">Urchin 6 中的日期比對能力比 Urchin 先前版本提供的功能更強大，也就是說： <ul><li>日期替代字元可能會於記錄檔案路徑名稱的任何一處出現；Urchin 先前的版本僅允許在實際檔名規格中使用替代字元 </li><li>現在已實行更穩固且靈活的資料模式比對演算法，雖然為了要有反向相容能力，先前的 YYYYMMDD 樣式模式比對仍舊有支援 </li></ul><p class="line874">最常用的時間比對變數與格式如下所示。所有支援的時間格式變數組列在本文結尾。 <p class="line874">* 星號比對零個或數個連續字元 2 位數的月份日期數字取代了 DD，例如 01-31 %d 等同於 DD 2 位數的月份數字取代了 MM，例如 01-12 %m 等同於 MM 2 位數的年份數字取代了 YY，例如 01-99 4 位數的年份數字取代了 YYYY，例如 0001-2003 %Y 等同於 YYYY <p class="line874">請注意，此情境中的星號運作方式類似 UNIX 或 DOS 中指令殼層的檔案名稱比對方式，不同於正規表示法 (Regular Expression) 比對方式。使用正規表示法時，此字元與前置字元的零個或數個範例相符。這些變數能以使用者選擇的任何方式合併。 <p class="line874">下列清單顯示變數範例如何轉譯 08/13/2003 的範例。請注意，13 之前的日期指定字 DD 和 %d 會轉換成日期。 <ul><li>YYYYMMDD 會轉譯為 20030812 </li><li>%Y-%m-%d 會轉譯為 2003-08-12 </li><li>%Y/%m/%d 會轉譯為 2003/08/12 (請注意此值在路徑中有其涵義) </li><li>*YYYYMMDD 會比對結尾字串為 20030812 的檔案名稱 </li></ul><p class="line874">日期指定字 DD 和 %d 依預設會轉換為先前日期，因為網頁伺服器的記錄方式及 Urchin 處理方式是以一般方式管理。記錄通常每天輪替，以防止記錄檔過大，因此每個記錄都包含單一日期的主要資料。午夜之前輪替的頻率最高，Urchin 則通常在午夜之後 (該月的隔天) 才會進行處理。如果您想要在輪替時新增 YYYYMMDD 樣式時間戳記至記錄檔名稱，那麼日期與 Urchin 執行時間會有一天的差異。在 Urchin 執行時評估日期轉換會導致記錄名稱搜尋失敗，因為記錄時間戳記會讀取 20030812，但 Urchin 於 20030813 執行。 <p class="line874">雖然這是記錄管理最常見的模式，但並非唯一選擇。所以 Urchin 有控制特定日期變數方式的組態參數。「記錄路徑名稱」設定中，「日期 / 時間萬用字元的替代字元」可以用來調整控制 DD 與 %d 評估方式的時區設定。本文結尾會更詳細地說明這項設定。 <p class="line874">年份、月份和日期變數可以用於記錄檔名稱或記錄檔的目錄 / 資料夾路徑內。星號則僅限記錄檔案路徑的檔案名稱部分使用。同樣地，時間格式變數可在記錄來源路徑中重複使用，但星號僅限使用一次。「程序」部分中的範例有助您釐清此概念。 <p class="line867"><strong>程序</strong> <p class="line874">建立或編輯「記錄來源」時，在「記錄設定」標籤下方「記錄檔案路徑」方塊路徑中，您應使用時間變數。舉例來說，常見的每日 Apache 網頁伺服器記錄輪替模式會建立包含日期戳記的記錄，日期戳記表示記錄項目的日期，例如在 07/16/2002 的午夜後 1 分鐘時，記錄輪替模式進行了記錄封存： <pre>/var/log/httpd/access.log
</pre><p class="line874">並將記錄儲存為 <pre>/var/log/httpd/access.log.20020715
</pre><p class="line874">若要在 Urchin「設定檔」的記錄來源中比對此模式，只要在「記錄檔案路徑」中指定 <pre>/var/log/httpd/access.log.YYYYMMDD
</pre><p class="line874">即可，Urchin 執行該日期時就會自動尋找先前日期的記錄。另一個範例如下，當 Microsoft 的 IIS 網頁伺服器設定為每天輪替記錄時，它會為記錄檔命名並在檔案名稱中包含目前日期，例如 ex021127.log。因此，若要處理每天的 IIS 記錄，您需在「設定檔記錄來源」的「記錄檔案路徑」欄位中使用如下的記錄檔規格： <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD.log
</pre><p class="line874">。 <p class="line874">若要允許 Urchin 處理輪替頻率短於一天的記錄，您可以合併使用 YYYYMMDD 語法與萬用字元，來比對先前日期建立的所有記錄檔。若要這樣做，您需確保輪替記錄檔命名方式的一致性，例如在檔案名稱後方附加小時。那麼在「記錄檔案路徑」規格中，您需使用以下的模式： <pre>/var/log/httpd/access.log.YYYYMMDD*
</pre><p class="line874">或 <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD*.log
</pre><p class="line874">若記錄存放在命名反映年份、月份和日期的目錄中，需採取更複雜的使用方式。假設您用來存放記錄的目錄路徑如下： <pre>/logs/2003/07
/logs/2003/08
/logs/2003/09
</pre><p class="line874">您將特定月份的所有記錄都存放在對應的目錄中，且每個記錄名稱後方都附加了該月份的日期 (例如 access.log.01、access.log.02)。若要允許 Urchin 找出要處理的記錄，您可以使用以下其中一種記錄路徑格式： <pre>/logs/YYYY/MM/access.log.DD
/logs/%Y/%M/access.log.%d
</pre><p class="line874">到了記錄處理時間，Urchin 就會處理所有符合昨天日期模式的記錄，無論其後置字元為何。就「記錄檔案路徑」欄位規格中的任何萬用字元使用而言，啟用「設定檔」的「記錄追蹤」至為重要，透過此方式得以確保 Urchin 不重複處理記錄。 <p class="line867"><strong>注意事項</strong> <p class="line874">若要判定取代模式的日期，Urchin 會以當地時間為根據，用目前時間減去 24 小時。它會以適當方式處理月份及年份範疇。但是，您可以使用記錄來源「進階設定」標籤下方、「記錄路徑名稱」設定中的「日期 / 時間萬用字元替代字元」加以調整。您可以選取 [當地時間] 或 [GMT] 時間做為時間調整的根據，然後使用「小時」編輯方塊以小時為單位指定加減時區。 <p class="line867"><strong>完整日期與時間格式參照</strong> <p class="line874">這是支援時間格式變數的完整清單，按照「標準 C 程式庫」strftime() 常式的慣例使用： <ul><li>%A = 營業日完整名稱的全國表示方式。 </li><li>%a = 營業日縮寫名稱的全國表示方式。 </li><li>%B = 月份完整名稱的全國表示方式。 </li><li>%b = 月份縮寫名稱的全國表示方式。 </li><li>%d = 月份日期以十進制表示 (01-31)。 </li><li>%e = 月份日期以十進制表示 (1-31)，單一數字前請留空白。 </li><li>%H = 小時 (24 小時制) 以十進制表示 (00-23)。 </li><li>%I = 小時 (12 小時制) 以十進制表示 (01-12)。 </li><li>%j = 年份日期以十進制表示 (001-366)。 </li><li>%k = 小時 (24 小時制) 以十進制表示 (0-23)，單一數字前請留空白。 </li><li>%l = 小時 (12 小時制) 以十進制表示 (1-12)，單一數字前請留空白。 </li><li>%M = 分鐘以十進制表示 (00-59)。 </li><li>%m = 月份以十進制表示 (01-12)。 </li><li>%p = 「上午」或「下午」的全國表示方式，視需要而定。 </li><li>%S = 秒數以十進制表示 (00-60)。 </li><li>%s = 自世界標準時間「時間點」至今的秒數 (請參閱 mktime(3))。 </li><li>%w = 營業日 (星期日是一週的第一天) 以十進制表示 (0-6)。 </li><li>%Y = 年份 (含世紀) 以十進制表示。 </li><li>%y = 年份 (不含世紀) 以十進制表示 (00-99)。 </li><li>%z = 世界標準時間 (UTC) 時區設定，開頭的加號代表 UTC 東區，減號代表 UTC 西區，接下來的數字代表小時和分鐘 (分別為兩個數字)，且不需以分隔字元區隔 (RFC 822 日期標題的常見形式)。 </li><li>%% = `%'. (日期 / 時間項目中需使用文字百分比符號時適用) </li></ul></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>