<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Guia de instalação do Urchin 6 (FreeBSD e Linux)</strong> <ul><li style="list-style-type:none"><p class="line891"><em>Este artigo é de autoria de</em> <a href="EpikOne.html">EpikOne</a><em>, um consultor autorizado do software Urchin</em> </li></ul><p class="line867"><strong>Antes de começar: observação importante para os usuários do Urchin 6.500</strong> <p class="line862">O Urchin 6.501 corrigiu vários problemas do programador de CPC (cost-per-click ou custo por clique). Se estiver fazendo a atualização do Urchin 6.500 para o Urchin 6.601, os dados de CPC processados talvez estejam incorretos ou incompletos, o que gera resultados incorretos nos relatórios do Urchin. Para obter dados corretos do Google AdWords, é recomendável (a) instalar o Urchin 6.601 em um novo local ou (b) se você quiser fazer a atualização da versão 6.500 existente, exclua os dados de CPC antigos. Nesse último caso, exclua todo o conteúdo dos diretórios a seguir: <p class="line867"><pre>&lt;path_to_urchin_6500_installation&gt;/data/cpc/...
&lt;path_to_urchin_6500_installation&gt;/data/history/cpc/...
</pre><p class="line874">Não será necessário fazer nada se você estiver fazendo a atualização a partir do Urchin 6.600, 6.501 ou do Urchin 6.402 e anterior. <p class="line867"><strong>Antes de começar - Observação importante para os usuários do FreeBSD</strong> <ul><li>O FreeBSD apresenta um limite de tamanho de dados de processo embutido em código de 500 MB, que é muito pequeno para permitir a execução do Urchin devido ao tamanho dos dados geográficos que devem residir na memória durante o processamento de registros. O erro que ocorrerá durante o tempo de execução é: </li></ul><p class="line867"><pre>ERRO: (8011-323-1057) falha ao alocar a memória
</pre><ul><li style="list-style-type:none">Para solucionar esse erro, você precisará aumentar o tamanho de dados de processo padrão do sistema FreeBSD, o que pode ser feito pela edição do arquivo /boot/loader.conf e pela adição destas linhas: </li></ul><p class="line867"><pre># Increase max process data segment size to 1GB
kern.maxdsiz="1073741824"
</pre><ul><li style="list-style-type:none">Será necessário reinicializar o sistema em seguida. </li><li>O FreeBSD tem um driver especial chamado accf_http. Ele executará buffer nas conexões de entrada até atingir um determinado número de solicitações HTTP completas para agilizar e otimizar o desempenho. Por padrão, esse driver não é carregado no kernel e você verá o seguinte aviso: </li></ul><p class="line867"><pre>[warn] (2)Nenhum arquivo ou diretório assim: falha ao ativar o filtro de aceitação "httpready"
</pre><ul><li style="list-style-type:none">Para evitar isso, você precisará ativar o módulo do kernel do FreeBSD (accf_http) do filtro de aceitação de HTTP. Para fazer isso, edite o arquivo /boot/loader.conf e adicione essas linhas: </li></ul><p class="line867"><pre># Wait for full HTTP request accept filter
accf_http_load="YES"
</pre><ul><li style="list-style-type:none">Será necessário reinicializar o sistema em seguida. </li></ul><p class="line867"><strong>AVISO</strong> Tenha muito cuidado ao alterar os limites do sistema dessa forma. Se você configurar  kern.maxdsiz para ser muito grande, seu sistema poderá se tornar não reinicializável. <strong>'Leia</strong> a documentação do FreeBSD antes de fazer essa modificação e avalie os possíveis riscos, conforme se apliquem à configuração específica de seu site. <p class="line867"><strong>Visão geral das etapas da instalação</strong> <ul><li>Instale o servidor de banco de dados desejado no sistema do Urchin ou adicione o banco de dados do Urchin a um servidor existente. No momento, os mecanismos de bancos de dados suportados são: <ul><li>MySQL 5.0.3 ou posterior (observação: a partir do Urchin 6.6, o MySQL 4.x.x não tem mais suporte) </li><li>PostgreSQL 8.2.5 ou posterior </li></ul></li><li>Crie o banco de dados e o usuário do Urchin no servidor de banco de dados e conceda permissões de acesso </li><li>Descompacte a distribuição do Urchin em um diretório temporário </li><li>Execute o script install.sh </li><li>Licencie a instalação do Urchin </li></ul><p class="line867"><strong>Opção 1: como usar o MySQL com o Urchin</strong> <ul><li><p class="line862">Se o servidor MySQL ainda não estiver instalado no sistema, você poderá obter uma distribuição em <a class="http" href="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a> </li><li>Instale o servidor MySQL de acordo com as instruções no site do MySQL </li><li>É necessário conhecer o login (root, por exemplo) e a senha de administrador do banco de dados do MySQL </li><li>Escolha o nome do banco de dados, a senha e o usuário do MySQL local que você usará com o Urchin. Salve essas informações, pois você precisará delas posteriormente durante a instalação do Urchin. O exemplo abaixo cria um banco de dados chamado urchin e um nome de usuário do MySQL com a senha urchinpassword (mas você deverá escolher sua própria senha) </li><li>Crie o banco de dados, o usuário e as permissões do Urchin com os seguintes comandos: </li></ul><p class="line867"><pre>root@yourserver# mysql -u root -p
mysql&gt; create database urchin character set utf8;
mysql&gt; GRANT ALL ON urchin.* to 'urchin'@'localhost' IDENTIFIED BY 'urchinpassword';
</pre><ul><li>Determine o nome do caminho do soquete MySQL para se comunicar com seu servidor MySQL. Geralmente, você o encontra no arquivo my.cnf da instalação do seu MySQL; procure pela linha socket=/var/lib/mysql/mysql.sock </li></ul><p class="line867"><strong>Opção 2: como usar o PostgreSQL com o Urchin</strong> <ul><li><p class="line862">Se o servidor PostgreSQL ainda não estiver instalado no sistema, você poderá obter uma distribuição em <a class="http" href="http://www.postgresql.org">http://www.postgresql.org</a> </li><li>Instale o servidor PostgreSQL de acordo com as instruções no site do PostgreSQL </li><li>O comando psql deverá estar em seu caminho e você deverá saber o login (pgsqlm, por exemplo) e a senha de administrador do banco de dados do PostgreSQL </li><li>Escolha o nome do banco de dados, a senha e o usuário do PostgreSQL local que você usará com o Urchin. Salve essas informações, pois você precisará delas posteriormente durante a instalação do Urchin. O exemplo abaixo cria um banco de dados chamado urchin e um nome de usuário do PostgreSQL com a senha urchinpass (mas você deverá escolher sua própria senha). </li><li>Crie o banco de dados, o usuário e as permissões do Urchin com os seguintes comandos: </li></ul><p class="line867"><pre>root@yourserver# psql -U pgsql -d postgres
postgres=# CREATE DATABASE urchin WITH ENCODING 'UTF8';
postgres=# CREATE USER urchin WITH PASSWORD 'urchinpass';
postgres=# GRANT ALL ON DATABASE urchin TO urchin;
postgres=# \connect urchin;
postgres=# CREATE LANGUAGE 'PLPGSQL';
</pre><p class="line867"><strong>Instalação do Urchin</strong> <ul><li>Verifique se você tem o nome do banco de dados, o nome de usuário e a senha do Urchin selecionados acima </li><li>Crie um diretório temporário e descompacte a distribuição do Urchin nesse diretório: <pre>mkdir /var/tmp/urchintemp
cd /var/tmp/urchintemp
tar xzvf urchin6601_&lt;platform&gt;_installer.tar.gz
</pre></li></ul><p class="line867"><strong>Importante</strong> Para que a instalação seja feita corretamente, não deve haver nenhuma instância “ativa” do Urchin 6 no computador de destino. Desative todas as versões existentes do Urchin 6 com o comando a seguir: <p class="line867"><pre>/path/to/urchin6/bin/urchinctl stop
</pre><ul><li>Se você precisar executar várias instâncias do Urchin 6 no mesmo computador, essas instâncias deverão (1) estar instaladas em locais diferentes, (2) ter portas de servidor da web diferentes e (3) conectar-se a bancos de dados diferentes. </li><li>O Urchin copia todos os arquivos necessários para as pastas de destino e substitui todos os arquivos existentes. Para manter intactas as personalizações existentes, será necessário instalar o Urchin 6 em um novo diretório ou renomear o diretório de instalação existente. </li><li>O Urchin 6.601 pode ser instalado desde o início ou atualizado a partir de uma versão existente do Urchin 6. <ul><li>Durante a “nova” instalação, o Urchin solicita que o usuário forneça todos os parâmetros de configuração, como porta de servidor da web, configurações do banco de dados etc. Para a “atualização”, o Urchin reutiliza a configuração da instância do Urchin 6 existente. </li><li>O Urchin 6.601 só pode ser usado para atualizar algumas versões anteriores do Urchin 6. As versões a seguir podem ser atualizadas: <ul><li>Urchin 6.6 - Versão em inglês: versão 6.600 </li><li>Urchin 6.5 - Service Pack 2: versão 6.501 </li><li>Urchin 6.5: versão 6.500 (consulte a observação importante acima) </li><li>Urchin 6 - Service Pack 1: versão 6.402 </li><li>Urchin 6 - Versão internacional: versão 6.401 </li><li>Urchin 6 - Versão em inglês: versão 6.400 </li></ul></li><li>Durante a “nova” instalação, o Urchin solicita que você "Inicialize as tabelas do banco de dados". Se quiser manter uma configuração existente do banco de dados, selecione “Não”. Nesse caso, embora o Urchin preserve a configuração existente (ele não recria as tabelas existentes), talvez seja necessário criar “tabelas adicionais” ou “colunas em tabelas existentes”. </li></ul></li><li>Agora execute o instalador do Urchin. Você pode executá-lo de modo interativo e seguir as solicitações digitando: </li></ul><p class="line867"><pre>./install.sh
</pre><p class="line874">Você também pode fazer uma instalação completa diretamente a partir da linha de comando, fornecendo todos os parâmetros necessários para a instalação. Para obter uma lista dos parâmetros de linha de comando, digite: <p class="line867"><pre>./install.sh -h
</pre><ul><li>Assim que o instalador for concluído, você terá uma versão em execução do Urchin em seu sistema. Para finalizar a instalação, aponte seu navegador da web favorito para este URL: </li></ul><p class="line867"><pre>http://yourserver:&lt;port&gt;
</pre><p class="line862">onde &lt;port&gt; é a porta de rede escolhida durante a instalação (o padrão é 9999). <ul><li>Se desejar restaurar os dados de relatório de perfil de uma versão mais antiga do Urchin 6, copie o histórico, os relatórios e todos os diretórios cpc existentes de /path/to/old-urchin6/data/ para o novo diretório /path/to/new-urchin6/data/. </li><li>Clique no link “Obter licença de demonstração” e siga as etapas de licenciamento para ativar o Urchin e realizar as etapas iniciais de configuração. </li></ul><p class="line867"><strong>Configuração do acompanhamento</strong> <p class="line874">Depois de o Urchin ser instalado, talvez seja necessário realizar etapas adicionais para configurar o acompanhamento de seu  website, dependendo de seu caso de uso. <p class="line867"><strong>Caso 1: como usar o Urchin com o acompanhamento de IP+User-Agent</strong> <p class="line874">Nenhuma configuração adicional é necessária. Ao adicionar perfis ao Urchin, especifique IP+User-Agent como método de acompanhamento de visitantes. <p class="line867"><strong>Caso 2: como usar o Urchin com o acompanhamento de UTM</strong> <p class="line862">Para usar o Urchin com o acompanhamento de UTM (Urchin Traffic Monitor ou Monitor de tráfego do Urchin), é necessário instalar uma pequena parte de código de acompanhamento JavaScript em cada página de seu website. Siga estas etapas: <ul><li><p class="line862">Copie os arquivos urchin.js e <tt class="backtick">__</tt>utm.gif do diretório util/utm da distribuição do Urchin na raiz do documento de seu website (por exemplo, o diretório de nível superior de seu conteúdo) </li><li>Em cada página de seu website, coloque o código de acompanhamento a seguir logo após as tags META da seção HEAD: </li></ul><p class="line867"><pre>&lt;script src="/urchin.js" type="text/javascript"&gt;
&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  _userv=0;
  urchinTracker();
&lt;/script&gt;
</pre><ul><li>Ao adicionar perfis ao Urchin, especifique UTM (Urchin Traffic Monitor ou Monitor de tráfego do Urchin) como método de acompanhamento de visitantes </li></ul><p class="line867"><strong>Caso 3: como usar o Urchin e o Google Analytics simultaneamente</strong> <p class="line874">Os novos recursos de rastreamento do código de acompanhamento "ga.js" do Google Analytics não são compatíveis com versões anteriores do Urchin 6. Se quiser acompanhar seu website com o Google Analytics e o software Urchin, recomendamos o uso do código de acompanhamento com base em urchin.js para obter melhores resultados. Se você optar por usar ga.js, não poderá usar os novos recursos de acompanhamento de ga.js. <p class="line874">Para usar o Urchin com um website que já esteja sendo acompanhado com o Google Analytics, será necessário fazer apenas uma pequena modificação em seu código de acompanhamento do Google Analytics. Siga estas etapas: <ul><li><p class="line862">Copie apenas o arquivo <tt class="backtick">__</tt>utm.gif do diretório util/utm da distribuição do Urchin para a raiz do documento de seu website (por exemplo, o diretório de nível superior de seu conteúdo). </li><li><p class="line862">Adicione a linha <tt>_userv=2;</tt> como mostrado abaixo ao código de acompanhamento das páginas de seu website. Não modifique nenhuma das outras partes do código de acompanhamento existente. </li></ul><p class="line867"><pre>&lt;script src="http://www.google-analytics.com/urchin.js"
type="text/javascript"&gt;
&lt;script type="text/javascript"&gt;
  _userv=2;
  _uacct="UA-XXXXXXX-Y";
  urchinTracker();
&lt;/script&gt;
</pre><ul><li>Ao adicionar perfis ao Urchin, especifique UTM como método de acompanhamento de visitantes </li></ul></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>