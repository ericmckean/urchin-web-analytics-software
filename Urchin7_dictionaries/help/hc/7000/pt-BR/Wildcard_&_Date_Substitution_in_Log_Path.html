<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><table id="top_location_line" width="100%"><table id="top_location_line" width="100%"><tr width="100%"><td><a href="http://www.urchin.com"><img border="0" src="../images/google_sm.gif" width="135" height="41"></a></td><td width="100%"><span id="top_line" style="width: 100%; float: left; clear: both; border-bottom: 1px solid #CCC;"><span id="top_title" style="float: left; margin-top: 10px;"><b>Help Center</b></span></td></tr></table>
<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en">
<p class="line867"><strong>Substituição do curinga e da data no caminho do registro</strong> <p class="line867"><strong>Visão geral</strong> <p class="line874">O Urchin permite especificar variáveis de correspondência de curinga e data no caminho para um arquivo de registro.Quando uma tarefa do Urchin é executada e o caminho do registro é lido, essas variáveis são convertidas e comparadas para obter correspondências com os diretórios e nomes de arquivos no seu sistema. <p class="line874">Os recursos de correspondência de data no Urchin 6 são mais extensos dos que os fornecidos em versões anteriores do Urchin, ou seja: <ul><li>A substituição de data pode ocorrer em qualquer ponto no nome do caminho do arquivo de registro; as versões anteriores do Urchin somente permitiam substituições na especiação de nome de arquivo real. </li><li>Foi implementado um algoritmo mais eficiente e flexível de correspondência de padrão de dados, embora ainda haja suporte para correspondência de padrão ao estilo AAAAMMDD, para compatibilidade com versões anteriores. </li></ul><p class="line874">As variáveis e os formatos mais comuns de correspondência de hora estão indicados a seguir.O conjunto completo de todas as variáveis de formatação de hora suportadas está listado no final deste artigo. <p class="line874">* um asterisco corresponde zero ou mais caracteres consecutivos DD é substituído pelo dia numérico de dois dígitos do mês; por exemplo, 01-31 %d equivale a DD MM é substituído pelo mês numérico de dois dígitos; por exemplo, 01-12 %m equivale a MM AA é substituído pelo ano numérico de dois dígitos; por exemplo, 01-99 AAAA é substituído pelo ano numérico de quatro dígitos; por exemplo, 0001-2003 %Y equivale a AAAA <p class="line874">Observe que o asterisco neste contexto se comporta como a correspondência de nome de arquivo que ocorreria em um shell de comando no UNIX ou no DOS e não como uma correspondência de expressão regular, na qual esse caractere corresponderia a zero ou mais instâncias do caractere precedente.Essas variáveis podem ser combinadas de qualquer maneira que o usuário escolher. <p class="line874">A lista abaixo mostra exemplos de como as instâncias dessas variáveis podem ser convertidas em 08/13/2003.Observe que os especificadores de dia DD e %d são convertidos no dia anterior a 13. <ul><li>AAAAMMDD pode ser convertido em 20030812 </li><li>%Y-%m-%d pode ser convertido em 2003-08-12 </li><li>%Y/%m/%d pode ser convertido em 2003/08/12 (observe que isso tem implicações em um caminho) </li><li>*AAAAMMDD pode corresponder a qualquer nome de arquivo que termine com a string 20030812 </li></ul><p class="line874">Os especificadores de dia DD e %d são convertidos no dia anterior por padrão devido à maneira como os registros do servidor da web e o processamento do Urchin são normalmente gerenciados.Em geral, os seus registros serão alternados diariamente para impedir que eles fiquem muito grandes e para que cada registro contenha principalmente dados referentes a um único dia.Esse rodízio ocorre com mais freqüência logo antes da meia-noite. O processamento do Urchin ocorreria geralmente depois desse horário, quando o relógio tivesse passado da meia-noite e entrado no próximo dia do mês.Se você adicionasse um carimbo de data e hora ao estilo AAAAMMDD ao nome do seu arquivo de registro à medida que ele fosse alternado, essa data e o tempo de execução do Urchin iriam diferir em um dia.A avaliação de uma conversão de dia no momento em que o Urchin é executado causaria um fracasso na localização do nome do registro correto, uma vez que o carimbo de data e hora do registro indicaria 20030812, mas o Urchin seria executado em 20030813. <p class="line874">Embora este seja o modelo mais comum para o gerenciamento de registros, ele não é a única opção.Por isso, o Urchin tem um parâmetro de configuração que controla a maneira como essas variáveis são resolvidas em um dia particular.A configuração "Substituição do curinga de data/hora no nome do caminho do registro" pode ser usada para fazer um ajuste de horário que controla como DD e %d são avaliados.Essa configuração é explicada com mais detalhes no final deste artigo. <p class="line874">As variáveis de ano, mês e dia podem ser usadas no nome do arquivo de registro ou no caminho de diretório/pasta para o arquivo de registro.O asterisco somente pode ser usado na parte de nome de arquivo do caminho do arquivo de registro.Além disso, variáveis de formato de hora podem ser repetidas dentro de um caminho de origem de registro, mas o asterisco pode ser usado apenas uma vez.Os exemplos na seção Procedimento ajudarão a esclarecer isso. <p class="line867"><strong>Procedimento</strong> <p class="line874">Ao criar ou editar uma Origem do registro, é necessário usar as variáveis de hora no caminho usado na caixa "Caminho do arquivo de registro", na guia "Configurações do registro".Como exemplo, um típico esquema de rodízio de registros de um servidor da web Apache cria um registro com o carimbo de data e hora indicando a data das entradas do registro; por exemplo, a 1 minuto após a meia-noite em 07/16/2002, o mecanismo de rodízio de registros arquiva o registro: <pre>/var/log/httpd/access.log
</pre><p class="line874">e o salva como <pre>/var/log/httpd/access.log.20020715
</pre><p class="line874">Para corresponder esse padrão na origem de registro para um Perfil do Urchin, basta especificar <pre>/var/log/httpd/access.log.YYYYMMDD
</pre><p class="line874">no Caminho do arquivo de registro, e o Urchin irá procurar automaticamente o registro do dia anterior quando for executado no dia em questão.Como outro exemplo, quando um servidor da web Microsoft IIS estiver configurado para alternar registros diariamente, ele nomeará o arquivo de registro e incluirá a data atual como parte do nome do arquivo; por exemplo, ex021127.log.Dessa forma, para processar um registro diário do IIS, você usaria uma especificação de arquivo de registro semelhante a esta: <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD.log
</pre><p class="line874">no campo "Caminho do arquivo de registro" da Origem do registro para o Perfil. <p class="line874">Para permitir que o Urchin processe registros que são alternados com mais freqüência do que simplesmente uma vez por dia, é possível usar uma combinação da sintaxe AAAAMMDD e de curingas para corresponder todos os arquivos de registro criados no dia anterior.Para fazer isso, seria preciso garantir que o arquivo de registro alternado tivesse sido nomeado consistentemente; por exemplo, com uma hora acrescentada ao nome do arquivo.Na especificação "Caminho do arquivo de registro", você usaria um padrão como: <pre>/var/log/httpd/access.log.YYYYMMDD*
</pre><p class="line874">ou <pre>C:\WINNT\System32\LogFiles\W3SVC1\exYYMMDD*.log
</pre><p class="line874">Um uso mais complexo seria aquele no qual os registros são armazenados em diretórios nomeados de forma a refletirem o ano, o mês e o dia.Suponha que você tivesse os seguintes caminhos de diretório para o armazenamento de registros: <pre>/logs/2003/07
/logs/2003/08
/logs/2003/09
</pre><p class="line874">e mantivesse todos os registros de um determinado mês em seus respectivos diretórios, com o dia do mês acrescentado a cada um desses registros (por exemplo, access.log.01, access.log.02).Para permitir que o Urchin descubra os registros a serem processados, você poderia usar um dos seguintes formatos de caminho de registro: <pre>/logs/YYYY/MM/access.log.DD
/logs/%Y/%M/access.log.%d
</pre><p class="line874">Nas ocasiões de processamento do registro, o Urchin irá processar todos os registros correspondentes ao padrão de data de ontem, com qualquer sufixo.Como no caso de qualquer uso de curingas na especificação do campo "Caminho do arquivo de registro", é importante que o Controle do registro para o Perfil esteja ativado, para garantir que o Urchin não repita o processamento dos registros. <p class="line867"><strong>Considerações</strong> <p class="line874">Para determinar a data para o padrão de substituição, o Urchin subtrai 24 horas do horário atual, com base no horário local.Ele irá lidar corretamente com as fronteiras de mês e ano.Entretanto, isso pode ser modificado com o uso da configuração "Substituição do curinga de data/hora no nome do caminho do registro", na guia "Configurações avançadas" de uma origem de registro.Você pode selecionar o horário local ou o horário GMT como base para os seus ajustes de hora e, em seguida, usando a caixa de edição "Horas", pode especificar um ajuste positivo ou negativo em horas. <p class="line867"><strong>Referência completa a formatos de data e hora</strong> <p class="line874">Esta é a lista completa de variáveis de formato de hora suportadas, que segue as convenções usadas na rotina strftime() da Biblioteca C padrão: <ul><li>%A = representação nacional do nome completo do dia da semana. </li><li>%a = representação nacional do nome abreviado do dia da semana. </li><li>%B = representação nacional do nome completo do mês. </li><li>%b = representação nacional do nome abreviado do mês. </li><li>%d = o dia do mês como um número decimal (01-31). </li><li>%e = o dia do mês como um número decimal (1-31); dígitos únicos são precedidos por um espaço em branco. </li><li>%H = a hora (relógio de 24 horas) como um número decimal (00-23). </li><li>%I = a hora (relógio de 12 horas) como um número decimal (01-12). </li><li>%j = o dia do ano como um número decimal (001-366). </li><li>%k = a hora (relógio de 24 horas) como um número decimal (0-23); dígitos únicos são precedidos por um espaço em branco. </li><li>%l = a hora (relógio de 12 horas) como um número decimal (1-12); dígitos únicos são precedidos por um espaço em branco. </li><li>%M = o minuto como um número decimal (00-59). </li><li>%m = o mês como um número decimal (01-12). </li><li>%p = representação nacional de "AM" ou "PM", conforme apropriado. </li><li>%S = o segundo como um número decimal (00-60). </li><li>%s = o número de segundos desde a Época, UTC (consulte mktime(3)). </li><li>%w = o dia da semana (domingo como o primeiro dia da semana) como um número decimal (0-6). </li><li>%Y = o ano, com século, como um número decimal. </li><li>%y = o ano, sem século, como um número decimal (00-99). </li><li>%z = o ajuste de fuso horário a partir de UTC; um sinal de mais à esquerda representa o leste de UTC, enquanto um sinal de menos representa o oeste de UTC, seguido de horas e minutos com dois dígitos cada e sem delimitador entre eles (forma comum para cabeçalhos de data RFC 822). </li><li>%% = `%'. (para uso quando um sinal de porcentagem literal for necessário dentro de uma entrada de data/hora) </li></ul></div><div id="pagebottom"></div>
</div>


<div id="footer" style="clear: both; margin: 0; padding: 0; border-bottom:1px solid #CCC;"></div><div id="copyright" style="font-size: 70%; text-align: center;">&copy;2010 Google</div>
</body></html>