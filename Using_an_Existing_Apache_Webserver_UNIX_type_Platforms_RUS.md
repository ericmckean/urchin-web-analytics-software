## Please edit system and help pages ONLY in the moinmaster wiki! For more
## information, please see MoinMaster:MoinPagesEditorGroup.
##acl MoinPagesEditorGroup:read,write,delete,revert All:read
##master-page:HelpTemplate
##master-date:Unknown-Date
#format wiki
#language en

'''Использование существующего веб-сервера Apache (на UNIX-подобных платформах)'''


По умолчанию для администрирования систем Urchin и создания отчетов используется автономный сервер Apache, поставляемый в комплекте с продуктом Urchin. В большинстве случаев этот способ является предпочтительным для реализации интерфейсов администрирования и создания отчетов Urchin. Тем не менее, иногда необходимо задействовать уже установленный сервер Apache. Например, если требуется использовать локализованную версию Apache в пределах всей компании или управлять веб-службами с помощью единой конфигурации Apache. Ниже описаны две модели, позволяющие обеспечить соответствие этим требованиям.

'''ОТКАЗ ОТ ОБЯЗАТЕЛЬСТВ.''' Обратите внимание, что такие модификации системы Urchin '''не поддерживаются'''.

'''Вариант 1.''' Запуск служб Urchin в виде отдельного экземпляра с помощью существующего двоичного кода HTTPD Apache, применяемого на конкретном сайте.

'''Побочные эффекты'''
  * Обновления Urchin, связанные с добавленными функциями и изменениями конфигурации поставляемой в комплекте версии Apache, могут работать некорректно, если существующий двоичный код Apache не поддерживает эти функции и изменения.

'''Изменения конфигурации'''

  * Убедитесь, что используемый HTTPD включает поддержку следующих модулей:
> > mod\_access
> > mod\_cgi
> > mod\_dir
> > mod\_mime
  * Установите Urchin в обычном режиме и выберите порт, через который будут работать интерфейсы администрирования и создания отчетов Urchin.
  * После установки Urchin выполните следующие команды:
```
                  cd /path/to/urchin/bin ./urchinctl stop
                  mv urchinwebd urchinwebd.orig
                  ln -s /path/to/your/httpd urchinwebd
                  ./urchinctl start
```
> > Запустится отдельный экземпляр Apache, использующий ваш двоичный код Apache, но выполняемый независимо от стандартных веб-служб.

'''Вариант 2.''' Запуск служб Urchin из существующей конфигурации Apache.

'''Побочные эффекты'''

  * Владельцем всего дистрибутива Urchin должен быть тот же пользователь (имеющий тот же идентификатор UID), от имени которого выполняется HTTPD.
  * С помощью графического интерфейса администрирования нельзя изменить порт, через который работает Urchin.
  * Службы Urchin нельзя запускать с помощью инструмента bin/wrapper, так как он попытается также выполнить HTTPD, связанный с Urchin. Скрипт bin/urchindctl.sh может использоваться только для запуска или остановки планировщика Urchin (urchind).

'''Изменения конфигурации'''


  * Добавьте приведенные ниже строки в существующий файл httpd.conf. Потребуется указать IP-адрес вашего сервера, номер порта, который будет использовать Urchin, а также путь к каталогу установки Urchin.
```
            ## Поддержка служб администрирования и создания отчетов Urchin
            Listen [port#]
            <VirtualHost [server-ip]:[port#]>
            ErrorLog /path/to/urchin-distribution/var/error.log
            DocumentRoot /path/to/urchin-distribution/htdocs/
            <Directory /path/to/urchin-distribution/htdocs/>
                  AddHandler cgi-script .cgi
                  Options ExecCGI
                  DirectoryIndex session.cgi
                  AllowOverride None
                  Order allow,deny
                  Allow from all
            </Directory>
            </VirtualHost> 
```

> После внесения этих изменений в конфигурацию выполните следующие действия:

  * В качестве владельца дистрибутива Urchin выберите пользователя, с идентификатором UID которого выполняется ваш веб-сервер Apache:
```
                  chown -R apache-user /path/to/urchin/bin
```

  * Убедитесь, что сервер Apache, поставляемый вместе с Urchin, остановлен:
```
                  cd /path/to/urchin/bin
                  ./urchinctl -w stop
```

  * Снова запустите сервер Apache, чтобы включить службы администрирования и создания отчетов Urchin.